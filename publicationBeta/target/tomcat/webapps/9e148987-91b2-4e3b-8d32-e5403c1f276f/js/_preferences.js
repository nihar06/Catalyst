/*
Copyright © 1998, 2014, Oracle and/or its affiliates.  All rights reserved.
*/
var _simulate_120_dpi=false;function IsTouchDevice(){return upk.browserInfo.isTouchDevice()}var upk=upk||{};
(function(a){var b="",d,g=false,h,v=false,A=false;a.getAgentInfo=function(){return typeof document.documentMode!="undefined"?navigator.userAgent+" - "+document.documentMode:navigator.userAgent};a.isSupportedBrowser=function(){var p=false;if(b=="MSIE"&&(d>=8||g&&h>=4))p=true;if(b=="Firefox"&&(d==24||d>=27))p=true;if(b=="Safari"&&d>=6)p=true;if(b=="Chrome"&&d>=32)p=true;if(a.isiOS())p=true;return p};a.isHardStop=function(){return b=="MSIE"&&d<=6};a.isMacOs=function(){return v};a.isFF3=function(){return A};
a.isFF=function(){return b=="Firefox"};a.isFF4=function(){return b=="Firefox"&&d==4};a.checkFFVersion=function(p){return b=="Firefox"&&d==p};a.isSafari=function(){return b=="Safari"||b=="Chrome"};a.isChrome=function(){return b=="Chrome"};a.isExplorer=function(){return b=="MSIE"};a.isIEVersion=function(p){return b=="MSIE"&&d==p};a.isIEQuirks=function(){if(a.isExplorer()==false)return false;return document.compatMode!=="CSS1Compat"};a.isIE8=function(){if(b!="MSIE")return false;return d==8&&g&&h==4};
a.isIE9=function(){if(b!="MSIE")return false;if(d==9&&g&&h==5)return true;if(d==7&&g&&h==5)return true;return g&&h==6&&(d!=10||document.documentMode!=10)};a.isIE10=function(){if(b!="MSIE")return false;return d==10&&g&&h==6&&document.documentMode==10};a.isIE10Compatibility=function(){if(b!="MSIE")return false;return g&&h==6&&(d!=10||document.documentMode!=10)};a.isIE10orHigher=function(){if(b!="MSIE")return false;return d>=10&&g&&h>=6&&document.documentMode>=10};a.isIE11=function(){if(b!="MSIE")return false;
return d==11&&g&&h==7&&document.documentMode==11};a.isIE11Compatibility=function(){if(b!="MSIE")return false;return g&&h==7&&(d!=11||document.documentMode!=11)};a.isActiveXEnabled=function(){var p=null,C="";try{new ActiveXObject("")}catch(B){C=B.name}try{p=!!new ActiveXObject("htmlfile")}catch(H){p=false}return C!="ReferenceError"&&p==false?false:true};a.isIE10Modern=function(){if(a.isIE10()==false)return false;return!a.isActiveXEnabled()};a.isiOS=function(){var p=navigator.platform;if(p==="iPad"||
p==="iPad Simulator"||p==="iPhone"||p==="iPod")return true;if(a.isChrome()&&a.isTouchDevice())return true;return false};a.isiOS5=function(){return navigator.userAgent.indexOf("CPU OS 5_")>=0};a.isiOS6=function(){return navigator.userAgent.indexOf("CPU OS 6_")>=0};a.isiOS7=function(){return navigator.userAgent.indexOf("CPU OS 7_")>=0};a.isTouchDevice=function(){return"ontouchstart"in window?window:null};a.isSoundSupported=function(){if(a.isiOS())return true;if(window.location.href.substr(0,7).toLowerCase()==
"file://")return false;if(swfobject.getFlashPlayerVersion().major>0)return true;return false};var j=navigator.userAgent,q=-1;if(j.indexOf("OPR")>=0){b="Opera";q=j.indexOf("OPR")+4}else if(j.indexOf("Chrome")>=0){b="Chrome";q=j.indexOf("Chrome")+7}else if(j.indexOf("Opera")>=0){b="Opera";q=j.indexOf("Opera")+6}else if(j.indexOf("Firefox")>=0){b="Firefox";q=j.indexOf("Firefox")+8}else if(j.indexOf("Safari")>=0){b="Safari";q=j.indexOf("Version")+8}else if(j.indexOf("MSIE")>=0){b="MSIE";q=j.indexOf("MSIE")+
5;var u=j.indexOf("Trident/");if(u>=0){g=true;h=parseInt(j.substr(u+8))}}else if(j.indexOf(" rv:")>=0){b="MSIE";q=j.indexOf(" rv:")+3;u=j.indexOf("Trident/");if(u>=0){g=true;h=parseInt(j.substr(u+8))}}else{b="";d=0}if(b!=""){d=parseInt(j.substr(q));if(isNaN(d)){q++;d=parseInt(j.substr(q))}parseInt(j.substr(q+2,1))}if(b=="Safari"&&isNaN(d))d=5;v=j.indexOf("Macintosh")>=0;A=b=="Firefox"&&j.indexOf("Firefox/3")>0})(upk.browserInfo={});function getDIV(a){return document.getElementById(a)}
function getDIVstyle(a){try{return document.getElementById(a).style}catch(b){return null}}function shiftTo(a,b,d){a=getDIVstyle(a);a.left=b+"px";a.top=d+"px"}function getUniWidth(a){return a.offsetWidth}function getUniHeight(a){return a.offsetHeight}function getClientWidth(a){return a.offsetWidth}function getClientHeight(a){return a.offsetHeight}function getObjHeight(a){return getDIV(a).offsetHeight}function getObjWidth(a){return getDIV(a).offsetWidth}
function getObjLeft(a){try{var b=getDIVstyle(a);return b.pixelLeft?b.pixelLeft:b.left!=""?parseInt(b.left):document.getElementById(a).offsetLeft}catch(d){return parseInt(a.offsetLeft)}}function getObjTop(a){try{var b=getDIVstyle(a);return b.pixelTop?b.pixelTop:b.top!=""?parseInt(b.top):document.getElementById(a).offsetTop}catch(d){return parseInt(a.offsetTop)}}function getInsideWindowWidth(){return window.innerWidth?window.innerWidth:document.body.clientWidth}
function getInsideWindowHeight(){return window.innerHeight?window.innerHeight:document.body.clientHeight}function getScrollLeft(){return window.pageXOffset||window.pageXOffset==0?window.pageXOffset:document.body.scrollLeft}function getScrollTop(){return window.pageYOffset||window.pageYOffset==0?window.pageYOffset:document.body.scrollTop}
function show(a,b){getDIVstyle(a).visibility="visible";if(b&&upk.browserInfo.isiOS())try{playMode=="S"&&showActObj.type=="Input"&&$("#"+a+" input").attr("readonly",true)}catch(d){}}function hide(a){getDIVstyle(a).visibility="hidden"}var __DPIwidth=0;
function getDpiInfo(){var a=document.getElementById("DPIInfoDiv");if(a!=null){__DPIwidth=a.clientWidth;if(__DPIwidth==0)__DPIwidth=96;__DPIwidth!=0&&document.getElementsByTagName("body")[0].removeChild(a)}return _simulate_120_dpi==true?120:__DPIwidth}function initDpiInfo(){document.write('<div id="DPIInfoDiv" style="visibility:hidden; width: 72pt; height: 1pt;">DPIINFODIV</div>')}function checkIEDPI(){return true}function Get_Element(a){return document.getElementById(a)}
function touch(a){if(a.originalEvent.touches&&a.originalEvent.touches.length)return a.originalEvent.touches[0];else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)return a.originalEvent.changedTouches[0]}function isNavBar(){return typeof navBar!=="undefined"}
function keyPressHandler(a){if((window.event?event.keyCode:a.keyCode)==(window.event?27:a.DOM_VK_ESCAPE)){if(parent.parent.isOpenDialog)if(parent.parent.isOpenDialog()){parent.parent.closeDialog();return}parent.parent.parent.parent.isOpenDialog&&parent.parent.parent.parent.isOpenDialog()&&parent.parent.parent.parent.closeDialog()}}
var requiredFlashVersion="9.0.124",_name="",_asyn=false,_fire=false,_knowpalyer=false,bPlayerIsAvailable=false,useAudioTag=false,useFlash=false,hasRequestedVersion,_fPlayerPath="",soundjs_initialized=false;
function SoundjsInit(){if(soundjs_initialized!=true){soundjs_initialized=true;var a=document.getElementById("fplayer");if(a)if(typeof assetType==="undefined")a.innerHTML="<audio id='upkaudio' onended='AudioEnded();' onerror='AudioError();' oncanplay='AudioLoaded()' style='display: none;'><Source type='audio/mpeg'></audio>";if(upk.browserInfo.isiOS5()&&typeof assetType==="undefined"){getAPlayer().addEventListener("loadstart",SoundPlayer_OnLoadStart);getAPlayer().addEventListener("durationchange",SoundPlayer_OnDurationChange)}hasRequestedVersion=
swfobject.hasFlashPlayerVersion(requiredFlashVersion);try{_fPlayerPath=_webpage_==true?"../../../../":"../../../"}catch(b){_fPlayerPath="../../../"}SupportAAC();CheckAndEnableSound()}}function SoundPlayer_OnLoadStart(){SoundPlayerObj.LoadStartTimer&&clearInterval(SoundPlayerObj.LoadStartTimer);if(getAPlayer().src)SoundPlayerObj.LoadStartTimer=setInterval("SoundPlayer_Started()",3E3)}
function SoundPlayer_OnDurationChange(){if(SoundPlayerObj.LoadStartTimer){clearInterval(SoundPlayerObj.LoadStartTimer);SoundPlayerObj.LoadStartTimer=0}}function SoundPlayer_Started(){getAPlayer().src=getAPlayer().src;getAPlayer().play()}function SupportAAC(){if(upk.browserInfo.isiOS()){bPlayerIsAvailable=useAudioTag=true;if(PlayerConfig.AACIsAvailable==true)return true}return false}
function CheckAndEnableSound(){var a=false;try{a=soundIsPublished()}catch(b){a=false}a==true&&hasRequestedVersion&&!IsTouchDevice()&&bPlayerIsAvailable==false&&UserPrefs.PlayAudio!="none"&&swfobject.embedSWF(_fPlayerPath+"audio/fplayer.swf","fplayer","1","1",requiredFlashVersion,null,null,null,null,onLoadFlash)}
function onLoadFlash(a){if(a.success==true)bPlayerIsAvailable=useFlash=true;document.getElementById("fplayer").style.position="absolute";document.getElementById("fplayer").style.top="0px";document.getElementById("fplayer").style.left="0px"}function AreCookiesEnabled(){if(PlayerConfig.EnableCookies==false)return false;chkcookie=(new Date).getTime()+"";document.cookie="chkcookie="+chkcookie+"; path=/";return document.cookie.indexOf(chkcookie,0)<0?false:true}
function Check_Flash(a,b){if(a==false)return true;if(SupportAAC()==true)return true;if(hasRequestedVersion==false)if(b!="none")return false;return true}function getFPlayer(){return document.getElementById("fplayer")}function getAPlayer(){return document.getElementById("upkaudio")}
function Sound_Init(a,b,d,g,h){SoundjsInit();if(Check_Flash(a,b)==true)return true;if(!SupportAAC()&&upk.browserInfo.isiOS())return true;a="../../../";if(h!=undefined)a=h;d!=null&&eval(d);sw=(screen.width-640)/2;sh=(screen.height-480)/2;if(g==null)g=true;KeepAlive_DoNotSendClose();if(g==true)window.open(a+"html/getflash.html?url="+Escape.MyEscape(this.location.href)+"&newwindow","","top="+sh+", left="+sw+", width=640, height=480, resizable=1,toolbar=1,scrollbars=1,location=1,statusbar=1,menubar=1");
else g=="parent"?setTimeout('parent.location.replace("'+a+"html/getflash.html?url="+Escape.MyEscape(parent.location.href)+'")',10):setTimeout('this.location.replace("'+a+"html/getflash.html?url="+Escape.MyEscape(this.location.href)+'")',10);return false}
function SoundPlayerClass(){for(this.TopicPath=unescape(window.location.href);this.TopicPath.indexOf("\\")!=-1;)this.TopicPath=this.TopicPath.replace("\\","/");var a=this.TopicPath.indexOf("?");if(a>=0)this.TopicPath=this.TopicPath.substr(0,a);a=this.TopicPath.lastIndexOf("/");this.RootPath=this.TopicPath=this.TopicPath.substr(0,a+1);for(var b=0;b<=3;b++){a=this.RootPath.lastIndexOf("/");if(a!=-1)this.RootPath=this.RootPath.substr(0,a)}this.RootPath+="/";this.SoundPath=this.TopicPath;this.AudioPath=
resolveUri(this.TopicPath,"../../../audio/");this.Volume=100;this.PlayCheckerTimer=this.LoadStartTimer=0}function resolveUri(a,b){return a+b}SoundPlayerClass.prototype.ChangeFileSuffix=function(a){if(a.lastIndexOf(".mp3")==a.length-4)return a;a=a.substr(0,a.length-4);if(PlayerConfig.AACIsAvailable||upk.browserInfo.isiOS())return a+".m4a";if(useFlash)return a+".flv";alert("sound - file extension error")};
SoundPlayerClass.prototype.Play=function(a,b,d,g){if(useFlash){var h=getFPlayer();if(h){h.style.top=getScrollTop()+"px";h.style.left=getScrollLeft()+"px"}}b||S_SetFrameState("S");h=S_GetFrameState();g||(g=false);if(bPlayerIsAvailable){d||(d=false);if(d==true)g==false&&OnEndPlaySound();else if(a.length==0){if(g==false){h!="D"&&S_SetFrameState("D");OnErrorPlaySound()}}else{if(a.substr(a.length-4)==".ASX"){d=sounds[a].duration.split(":");try{_lastAudioFileSize=parseInt(d[0])*3600+parseInt(d[1])*60+parseFloat(d[2])}catch(v){_lastAudioFileSize=
0}a=sounds[a].flist[0]}SoundPlayer_Stop();if(a.length==0){if(g==false){h!="D"&&S_SetFrameState("D");OnErrorPlaySound()}}else{fname=b?resolveUri(this.AudioPath,a):resolveUri(this.SoundPath,a);_name=this.ChangeFileSuffix(fname);_asyn=g;_fire=true;if(useFlash)_knowpalyer==true&&setTimeout('SoundPlayer_Open("'+_name+'",'+g+")",120);else useAudioTag&&setTimeout('SoundPlayer_Open("'+_name+'",'+g+")",120)}}}else if(g==false){h!="D"&&S_SetFrameState("D");OnErrorPlaySound()}};
SoundPlayerClass.prototype.Stop=function(a){if(bPlayerIsAvailable)a?SoundPlayer_Stop():setTimeout("SoundPlayer_Stop()",10)};SoundPlayerClass.prototype.Pause=function(){try{if(bPlayerIsAvailable){useFlash&&getFPlayer().SoundPause();useAudioTag&&getAPlayer().pause()}}catch(a){}};SoundPlayerClass.prototype.Resume=function(){if(!InWebpage())if(getLastSoundFileName()!=getActualSoundFileName())return;try{if(bPlayerIsAvailable){useFlash&&getFPlayer().SoundPlay();useAudioTag&&getAPlayer().play()}}catch(a){}};
SoundPlayerClass.prototype.InitAudioPlayer=function(){if(bPlayerIsAvailable)if(useAudioTag){getAPlayer().src=this.AudioPath+"empty.m4a";getAPlayer().play()}};SoundPlayerClass.prototype.IsAvailable=function(){return bPlayerIsAvailable};SoundPlayerClass.prototype.SetSoundPath=function(a){if(a.length>0)this.SoundPath=a};
SoundPlayerClass.prototype.SetVolume=function(a){if(a==null)a=this.Volume;else this.Volume=a;if(useFlash)try{getFPlayer().SetSoundVolume(a/100)}catch(b){}if(useAudioTag)try{getAPlayer().volume=a/100}catch(d){}};function InWebpage(){if(typeof _webpage_==="undefined")return false;return _webpage_}function SoundPlayer_EndCheck(){getAPlayer().ended&&SoundPlayerObj.PlayCheckerTimer&&setTimeout(function(){SoundPlayerObj.PlayCheckerTimer&&SoundComplete(false)},50)}
var _lastAsyncronFile=false,_lastAudioFile="",_lastFlashTime=-1,_lastAudioFileSize=0,_lastFileName="";function clearLastSoundFileName(){_lastFileName=""}function getLastSoundFileName(){return _lastFileName.substr(_lastFileName.lastIndexOf("/")+1)}function getActualSoundFileName(){try{return sounds[showActObj.id.substr(1)+".ASX"].flist[0]}catch(a){return""}}
function SoundPlayer_Open(a,b){if(a.length>0)_lastFileName=a;try{if(a.length>0&&b==true)_lastAsyncronFile=true;if(timelineDescriptor.valid&&timelineDescriptor.type!="narration")throw"";if(useFlash){audio_loading=true;_lastFlashTime=-1;getFPlayer().SetSoundFile(a);getFPlayer().SoundPlay();if(timelineDescriptor.valid&&timelineDescriptor.type=="narration"){SoundFPlayer_SetTime();return}audio_loading=false}if(useAudioTag){audio_loading=true;getAPlayer().pause();if(_lastAudioFile==a)AudioLoaded();else{getAPlayer().src=
a;CLog(a+" - "+_lastAudioFile+" play")}_lastAudioFile=a}SoundPlayerObj.SetVolume();if(upk.browserInfo.isiOS()){SoundPlayerObj.PlayCheckerTimer&&clearInterval(SoundPlayerObj.PlayCheckerTimer);SoundPlayerObj.PlayCheckerTimer=setInterval("SoundPlayer_EndCheck()",500)}}catch(d){S_SetFrameState("D");b==false&&OnErrorPlaySound()}}
function SoundFPlayer_SetTime(){getFPlayer().SoundPause();getFPlayer().SoundSeek(timelineDescriptor.resttime/1E3);if(Math.abs(timelineDescriptor.resttime/1E3-getFPlayer().Time())<0.3){getFPlayer().SoundPlay();audio_loading=false}else setTimeout("SoundFPlayer_SetTime()",300)}
function SoundAPlayer_SetTime(){if(audio_seeking!=false)if(audio_counter>100)setTimeout("AudioReload();",100);else{audio_counter++;var a=0;if(timelineDescriptor.valid==true&&timelineDescriptor.type=="narration"){a=timelineDescriptor.resttime/1E3;if(a>_lastAudioFileSize-1){getAPlayer().pause();SoundComplete();CLog("nextframe");return}if(a<0)a=0}try{getAPlayer().currentTime=a}catch(b){setTimeout("SoundAPlayer_SetTime()",300)}var d=getAPlayer().currentTime,g=Math.abs(d-a);try{CLog("d: "+g+" "+d+" "+
a+" "+_lastAudioFileSize+" "+showScreen)}catch(h){CLog("d: "+g+" "+d+" "+a+" "+_lastAudioFileSize)}if(g<0.3){audio_seeking=false;CLog("play...");getAPlayer().play()}else setTimeout("SoundAPlayer_SetTime()",300)}}function SoundIsLocked(){return audio_loading==true||audio_seeking==true}
function SoundPlayer_Stop(){try{if(SoundPlayerObj.PlayCheckerTimer){clearInterval(SoundPlayerObj.PlayCheckerTimer);SoundPlayerObj.PlayCheckerTimer=0}_lastAsyncronFile=false;useFlash&&getFPlayer().SoundStop();useAudioTag&&getAPlayer().pause()}catch(a){}}
function SoundPlayer_GetTime(){var a=getLastSoundFileName(),b=showActObj.id.substr(1);b=sounds[b+".ASX"].flist[0];if(a.length>0&&a!=b)return{s:a,t:NaN};b=0;if(useAudioTag)b=getAPlayer().currentTime*1E3;if(useFlash)b=getFPlayer().Time()*1E3;if(b==0&&_lastFlashTime>=0)b=_lastFlashTime;else _lastFlashTime=b;return{s:a,t:b}}function OnFlashLoad(){_fire==true&&setTimeout('SoundPlayer_Open("'+_name+'",'+_asyn+")",20);_fire_=false;_knowpalyer=true}
function SoundComplete(a){if(InWebpage())a?OnErrorPlaySound():OnEndPlaySound();else{if(SoundPlayerObj.PlayCheckerTimer){clearInterval(SoundPlayerObj.PlayCheckerTimer);SoundPlayerObj.PlayCheckerTimer=0}if(_lastAsyncronFile)_lastAsyncronFile=false;else{if(useAudioTag)if(a){S_SetFrameState("D");OnErrorPlaySound()}else{if(typeof animObject!="undefined")if(animObject)if(fusionmode==true&&animObject.timeout==DELAY_INFINITE*100){if(animObject.showbubble==false)animObject.timeout=0}else animObject.timeout=
0;OnEndPlaySound()}if(useFlash){s=getFPlayer().SoundState();if(s=="notfoundfile"){S_SetFrameState("D");OnErrorPlaySound()}else if(s=="complete"){if(typeof animObject!="undefined")if(animObject)if(fusionmode==true&&animObject.timeout==DELAY_INFINITE*100){if(animObject.showbubble==false)animObject.timeout=0}else animObject.timeout=0;OnEndPlaySound()}}}}}function AudioEnded(){var a=getAPlayer();CLog(a.src+" done...");a.src.indexOf("empty.m4a")>=0||SoundComplete(false)}
function AudioError(){var a=getAPlayer();if(a!=null)if(a.src!="")if(!(a.src.indexOf("empty.m4a")>=0)){CLog(a.src+" error...");SoundComplete(true)}}var audio_loading=false,audio_seeking=false,audio_counter=0;function AudioReload(){audio_loading=true;getAPlayer().pause();getAPlayer().src=_lastAudioFile;CLog(fname+" - "+_lastAudioFile+" replay")}
function AudioLoaded(){CLog("AudioLoaded");if(audio_loading==true){CLog("AudioLoaded true");audio_loading=false;audio_counter=0;getAPlayer().pause();audio_seeking=true;SoundAPlayer_SetTime()}}function S_GetFrameState(){try{return upk.Timeline.GetFrameState()}catch(a){return""}}function S_SetFrameState(a){try{upk.Timeline.SetFrameState(a)}catch(b){}}
function TimelineDescriptor(a,b,d,g,h,v){if(this.valid=a){this.frameid=b;this.timelineindex=d;this.narration=g;this.animation=h;this.resttime=v;this.type="narration";if(v>=g)this.type="animationstart";if(v>=g+h/2)this.type="nextframe"}}var timelineDescriptor=new TimelineDescriptor(false,"",0,0,0,0),SoundPlayerObj=new SoundPlayerClass,clog_enabled=false;function CLog(a,b){if(clog_enabled||b==true)console!==undefined&&console.log(a)}
var swfobject=function(){function a(){if(!M){try{var c=m.getElementsByTagName("body")[0].appendChild(m.createElement("span"));c.parentNode.removeChild(c)}catch(e){return}M=true;c=S.length;for(var f=0;f<c;f++)S[f]()}}function b(c){if(M)c();else S[S.length]=c}function d(c){if(typeof z.addEventListener!=n)z.addEventListener("load",c,false);else if(typeof m.addEventListener!=n)m.addEventListener("load",c,false);else if(typeof z.attachEvent!=n)H(z,"onload",c);else if(typeof z.onload=="function"){var e=
z.onload;z.onload=function(){e();c()}}else z.onload=c}function g(){var c=m.getElementsByTagName("body")[0],e=m.createElement(D);e.setAttribute("type",E);var f=c.appendChild(e);if(f){var i=0;(function(){if(typeof f.GetVariable!=n){try{var k=f.GetVariable("$version")}catch(t){}if(k){k=k.split(" ")[1].split(",");l.pv=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}else if(i<10){i++;setTimeout(arguments.callee,10);return}c.removeChild(e);f=null;h()})()}else h()}function h(){var c=I.length;if(c>
0)for(var e=0;e<c;e++){var f=I[e].id,i=I[e].callbackFn,k={success:false,id:f};if(l.pv[0]>0){var t=B(f);if(t)if(J(I[e].swfVersion)&&!(l.wk&&l.wk<312)){y(f,true);if(i){k.success=true;k.ref=v(f);i(k)}}else if(I[e].expressInstall&&A()){k={};k.data=I[e].expressInstall;k.width=t.getAttribute("width")||"0";k.height=t.getAttribute("height")||"0";if(t.getAttribute("class"))k.styleclass=t.getAttribute("class");if(t.getAttribute("align"))k.align=t.getAttribute("align");var o={};t=t.getElementsByTagName("param");
for(var w=t.length,x=0;x<w;x++)if(t[x].getAttribute("name").toLowerCase()!="movie")o[t[x].getAttribute("name")]=t[x].getAttribute("value");j(k,o,f,i)}else{q(t);i&&i(k)}}else{y(f,true);if(i){if((f=v(f))&&typeof f.SetVariable!=n){k.success=true;k.ref=f}i(k)}}}}function v(c){var e=null;if((c=B(c))&&c.nodeName=="OBJECT")if(typeof c.SetVariable!=n)e=c;else if(c=c.getElementsByTagName(D)[0])e=c;return e}function A(){return!T&&J("6.0.65")&&(l.win||l.mac)&&!(l.wk&&l.wk<312)}function j(c,e,f,i){T=true;Z=i||
null;ba={success:false,id:f};var k=B(f);if(k){if(k.nodeName=="OBJECT"){Q=u(k);U=null}else{Q=k;U=f}c.id=N;if(typeof c.width==n||!/%$/.test(c.width)&&parseInt(c.width,10)<310)c.width="310";if(typeof c.height==n||!/%$/.test(c.height)&&parseInt(c.height,10)<137)c.height="137";m.title=m.title.slice(0,47)+" - Flash Player Installation";i=l.ie&&l.win?"ActiveX":"PlugIn";i="MMredirectURL="+z.location.toString().replace(/&/g,"%26")+"&MMplayerType="+i+"&MMdoctitle="+m.title;if(typeof e.flashvars!=n)e.flashvars+=
"&"+i;else e.flashvars=i;if(l.ie&&l.win&&k.readyState!=4){i=m.createElement("div");f+="SWFObjectNew";i.setAttribute("id",f);k.parentNode.insertBefore(i,k);k.style.display="none";(function(){k.readyState==4?k.parentNode.removeChild(k):setTimeout(arguments.callee,10)})()}p(c,e,f)}}function q(c){if(l.ie&&l.win&&c.readyState!=4){var e=m.createElement("div");c.parentNode.insertBefore(e,c);e.parentNode.replaceChild(u(c),e);c.style.display="none";(function(){c.readyState==4?c.parentNode.removeChild(c):setTimeout(arguments.callee,
10)})()}else c.parentNode.replaceChild(u(c),c)}function u(c){var e=m.createElement("div");if(l.win&&l.ie)e.innerHTML=c.innerHTML;else if(c=c.getElementsByTagName(D)[0])if(c=c.childNodes)for(var f=c.length,i=0;i<f;i++)!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&c[i].nodeType!=8&&e.appendChild(c[i].cloneNode(true));return e}function p(c,e,f){var i,k=B(f);if(l.wk&&l.wk<312)return i;if(k){if(typeof c.id==n)c.id=f;if(l.ie&&l.win){var t="",o;for(o in c)if(c[o]!=Object.prototype[o])if(o.toLowerCase()==
"data")e.movie=c[o];else if(o.toLowerCase()=="styleclass")t+=' class="'+c[o]+'"';else if(o.toLowerCase()!="classid")t+=" "+o+'="'+c[o]+'"';o="";for(var w in e)if(e[w]!=Object.prototype[w])o+='<param name="'+w+'" value="'+e[w]+'" />';k.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+t+">"+o+"</object>";V[V.length]=c.id;i=B(c.id)}else{w=m.createElement(D);w.setAttribute("type",E);for(var x in c)if(c[x]!=Object.prototype[x])if(x.toLowerCase()=="styleclass")w.setAttribute("class",
c[x]);else x.toLowerCase()!="classid"&&w.setAttribute(x,c[x]);for(t in e)if(e[t]!=Object.prototype[t]&&t.toLowerCase()!="movie"){c=w;o=t;x=e[t];f=m.createElement("param");f.setAttribute("name",o);f.setAttribute("value",x);c.appendChild(f)}k.parentNode.replaceChild(w,k);i=w}}return i}function C(c){var e=B(c);if(e&&e.nodeName=="OBJECT")if(l.ie&&l.win){e.style.display="none";(function(){if(e.readyState==4){var f=B(c);if(f){for(var i in f)if(typeof f[i]=="function")f[i]=null;f.parentNode.removeChild(f)}}else setTimeout(arguments.callee,
10)})()}else e.parentNode.removeChild(e)}function B(c){var e=null;try{e=m.getElementById(c)}catch(f){}return e}function H(c,e,f){c.attachEvent(e,f);O[O.length]=[c,e,f]}function J(c){var e=l.pv;c=c.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return e[0]>c[0]||e[0]==c[0]&&e[1]>c[1]||e[0]==c[0]&&e[1]==c[1]&&e[2]>=c[2]?true:false}function P(c,e,f,i){if(!(l.ie&&l.mac)){var k=m.getElementsByTagName("head")[0];if(k){f=f&&typeof f=="string"?f:"screen";if(i)aa=F=null;
if(!F||aa!=f){i=m.createElement("style");i.setAttribute("type","text/css");i.setAttribute("media",f);F=k.appendChild(i);if(l.ie&&l.win&&typeof m.styleSheets!=n&&m.styleSheets.length>0)F=m.styleSheets[m.styleSheets.length-1];aa=f}if(l.ie&&l.win)F&&typeof F.addRule==D&&F.addRule(c,e);else F&&typeof m.createTextNode!=n&&F.appendChild(m.createTextNode(c+" {"+e+"}"))}}}function y(c,e){if(ca){var f=e?"visible":"hidden";if(M&&B(c))B(c).style.visibility=f;else P("#"+c,"visibility:"+f)}}function r(c){return/[\\\"<>\.;]/.exec(c)!=
null&&typeof encodeURIComponent!=n?encodeURIComponent(c):c}var n="undefined",D="object",E="application/x-shockwave-flash",N="SWFObjectExprInst",z=window,m=document,K=navigator,da=false,S=[function(){da?g():h()}],I=[],V=[],O=[],Q,U,Z,ba,M=false,T=false,F,aa,ca=true,l=function(){var c=typeof m.getElementById!=n&&typeof m.getElementsByTagName!=n&&typeof m.createElement!=n,e=K.userAgent.toLowerCase(),f=K.platform.toLowerCase(),i=f?/win/.test(f):/win/.test(e);f=f?/mac/.test(f):/mac/.test(e);e=/webkit/.test(e)?
parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false;var k=!+"\u000b1",t=[0,0,0],o=null;if(typeof K.plugins!=n&&typeof K.plugins["Shockwave Flash"]==D){if((o=K.plugins["Shockwave Flash"].description)&&!(typeof K.mimeTypes!=n&&K.mimeTypes[E]&&!K.mimeTypes[E].enabledPlugin)){da=true;k=false;o=o.replace(/^.*\s+(\S+\s+\S+$)/,"$1");t[0]=parseInt(o.replace(/^(.*)\..*$/,"$1"),10);t[1]=parseInt(o.replace(/^.*\.(.*)\s.*$/,"$1"),10);t[2]=/[a-zA-Z]/.test(o)?parseInt(o.replace(/^.*[a-zA-Z]+(.*)$/,
"$1"),10):0}}else if(typeof z.ActiveXObject!=n)try{var w=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(w)if(o=w.GetVariable("$version")){k=true;o=o.split(" ")[1].split(",");t=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)]}}catch(x){}return{w3:c,pv:t,wk:e,ie:k,win:i,mac:f}}();(function(){if(l.w3){if(typeof m.readyState!=n&&m.readyState=="complete"||typeof m.readyState==n&&(m.getElementsByTagName("body")[0]||m.body))a();if(!M){typeof m.addEventListener!=n&&m.addEventListener("DOMContentLoaded",
a,false);if(l.ie&&l.win){m.attachEvent("onreadystatechange",function(){if(m.readyState=="complete"){m.detachEvent("onreadystatechange",arguments.callee);a()}});z==top&&function(){if(!M){try{m.documentElement.doScroll("left")}catch(c){setTimeout(arguments.callee,0);return}a()}}()}l.wk&&function(){M||(/loaded|complete/.test(m.readyState)?a():setTimeout(arguments.callee,0))}();d(a)}}})();(function(){l.ie&&l.win&&window.attachEvent("onunload",function(){for(var c=O.length,e=0;e<c;e++)O[e][0].detachEvent(O[e][1],
O[e][2]);c=V.length;for(e=0;e<c;e++)C(V[e]);for(var f in l)l[f]=null;l=null;for(var i in swfobject)swfobject[i]=null;swfobject=null})})();return{registerObject:function(c,e,f,i){if(l.w3&&c&&e){var k={};k.id=c;k.swfVersion=e;k.expressInstall=f;k.callbackFn=i;I[I.length]=k;y(c,false)}else i&&i({success:false,id:c})},getObjectById:function(c){if(l.w3)return v(c)},embedSWF:function(c,e,f,i,k,t,o,w,x,R){var W={success:false,id:e};if(l.w3&&!(l.wk&&l.wk<312)&&c&&e&&f&&i&&k){y(e,false);b(function(){f+="";
i+="";var L={};if(x&&typeof x===D)for(var G in x)L[G]=x[G];L.data=c;L.width=f;L.height=i;G={};if(w&&typeof w===D)for(var X in w)G[X]=w[X];if(o&&typeof o===D)for(var Y in o)if(typeof G.flashvars!=n)G.flashvars+="&"+Y+"="+o[Y];else G.flashvars=Y+"="+o[Y];if(J(k)){X=p(L,G,e);L.id==e&&y(e,true);W.success=true;W.ref=X}else if(t&&A()){L.data=t;j(L,G,e,R);return}else y(e,true);R&&R(W)})}else R&&R(W)},switchOffAutoHideShow:function(){ca=false},ua:l,getFlashPlayerVersion:function(){return{major:l.pv[0],minor:l.pv[1],
release:l.pv[2]}},hasFlashPlayerVersion:J,createSWF:function(c,e,f){if(l.w3)return p(c,e,f)},showExpressInstall:function(c,e,f,i){l.w3&&A()&&j(c,e,f,i)},removeSWF:function(c){l.w3&&C(c)},createCSS:function(c,e,f,i){l.w3&&P(c,e,f,i)},addDomLoadEvent:b,addLoadEvent:d,getQueryParamValue:function(c){var e=m.location.search||m.location.hash;if(e){if(/\?/.test(e))e=e.split("?")[1];if(c==null)return r(e);e=e.split("&");for(var f=0;f<e.length;f++)if(e[f].substring(0,e[f].indexOf("="))==c)return r(e[f].substring(e[f].indexOf("=")+
1))}return""},expressInstallCallback:function(){if(T){var c=B(N);if(c&&Q){c.parentNode.replaceChild(Q,c);if(U){y(U,true);if(l.ie&&l.win)Q.style.display="block"}Z&&Z(ba)}T=false}}}}();function Cookie(a,b,d,g,h,v){this.$document=a;this.$name=b;if(d=="today"){a=new Date;a.setHours(23);a.setMinutes(59);a.setSeconds(59);this.$exp=a}else this.$exp=d?new Date((new Date).getTime()+d*864E5):null;this.$path=g?g:null;this.$domain=h?h:null;this.$secure=v?true:false}
Cookie.prototype.Store=function(){if(PlayerConfig.EnableCookies){var a="",b;for(b in this)if(!(b.charAt(0)=="$"||typeof this[b]=="function")){if(a!="")a+="&";a+=b+":"+escape(this[b])}a=this.$name+"="+a;if(this.$exp)a+="; expires="+this.$exp.toGMTString();if(this.$path)a+="; path="+this.$path;if(this.$domain)a+="; domain="+this.$domain;if(this.$secure)a+="; secure=";this.$document.cookie=a}};
Cookie.prototype.Load=function(){if(!PlayerConfig.EnableCookies)return false;var a=this.$document.cookie;if(a=="")return false;var b=a.indexOf(this.$name+"=");if(b==-1)return false;b+=this.$name.length+1;var d=a.indexOf(";",b);if(d==-1)d=a.length;a=decodeURIComponent(a.substring(b,d)).split("&");for(b=0;b<a.length;b++){d=a[b].split(":");this[d[0]]=unescape(d[1])}return true};
Cookie.prototype.Remove=function(){if(PlayerConfig.EnableCookies){var a=this.$name+"=";if(this.$path)a+="; path="+this.$path;if(this.$domain)a+="; domain="+this.$domain;a+="; expires=Fri, 02-Jan-1970 00:00:00 GMT";this.$document.cookie=a}};
var Escape=function(){function a(h,v){for(var A="",j=0;j<h.length;j++){var q=h.substr(j,1),u;if(v==0)u=q>="0"&&q<="9"||q>="a"&&q<="z"||q>="A"&&q<="Z";else{a:{u=g.length;for(var p=0;p<u;p++)if(q==g[p]){u=true;break a}u=q==d?true:false}u=!u}if(u)A+=q;else{q=h.charCodeAt(j);q="0000"+q.toString(16).toUpperCase();A+=(v==0?"$":d)+q.substr(q.length-4)}}return A}function b(h,v){for(var A="",j=false,q=0;q<h.length;q++){var u;if(j){u=h.substr(q,4);A+=String.fromCharCode(parseInt("0x"+u));q+=3;j=false}else{u=
h.substr(q,1);if(u==(v==0?"$":d))j=true;else A+=u}}return A}var d="/",g=["<",">",'"',"'","%",";","(",")","&","+"];return{SafeUriEscape:function(h){return a(h,1)},SafeUriUnEscape:function(h){return b(h,1)},MyEscape:function(h){return a(h,0)},MyUnEscape:function(h){return b(h,0)}}}();function UrlParser(){this.params=[];this.safemode=false}
UrlParser.prototype.Clone=function(){var a=new UrlParser;a.params=[];a.safemode=this.safemode;for(var b in this.params)if(this.params[b]!=null)a.params[b]=this.params[b];return a};
UrlParser.prototype.Parse=function(){var a,b;a=document.location.hash.substring(1);a=a.split("&");if(a.length==0||a[0]==""){a=document.location.search.substring(1);a=a.split("&")}if(a.length>0)if(a[0].toLowerCase().substr(0,3)=="su="){this.safemode=true;a=a[0].substr(3);a=Escape.SafeUriUnEscape(a);a=a.split("&")}for(var d=0;d<a.length;d++){b=a[d];if(b.length!=0){var g=b.split("=");if(g.length==2)this.params[g[0].toLowerCase()]=g[1];else if(g.length<2)this.params[g[0].toLowerCase()]="";else this.params[g[0].toLowerCase()]=
b.substr(g[0].length+1)}}};UrlParser.prototype.GetSafeMode=function(){return this.safemode};UrlParser.prototype.SetSafeMode=function(a){this.safemode=a};UrlParser.prototype.GetParameter=function(a){return this.params[a.toLowerCase()]};UrlParser.prototype.AddParameter=function(a,b){this.params[a.toLowerCase()]=b};UrlParser.prototype.RemoveParameter=function(a){this.params[a.toLowerCase()]=null};UrlParser.prototype.ClearParameterList=function(){this.params=null;this.params=[]};
UrlParser.prototype.BuildParameterList=function(a){a="";var b=true,d;for(d in this.params){var g=this.params[d];if(g!=null){if(b==false)a+="&";b=false;a+=g.length==0?d:d+"="+this.params[d]}}if(this.safemode)a="su="+Escape.MyEscape(a);return a};
UrlParser.prototype.GetCorrectUrl=function(a,b){if(!this.safemode)return a;var d,g=a.indexOf("#");if(g==-1)g=a.indexOf("?");if(g>=0){var h=a.substring(g+1);d=h.split("&");if(d[0].toLowerCase().substr(0,3)=="su=")return a;return a.substring(0,g+1)+"su="+Escape.SafeUriEscape(h)}else return a+(b?"":"?su=")};function UnescapeQuotes(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}
function onHelp(a){if(a.charAt(a.length-1)=="/")a=a.substr(0,a.length-1);if(a.length>0)a+="/";var b=screen.availWidth/17,d=screen.availHeight-3*b;if(d>500)d=500;d=d*4.5/3;window.open(a+"../help/toc.html","odhelp","width=637,height=390,left="+b+",top="+b+",resizable=1,toolbar=1,scrollbars=1,location=0,menubar=0").focus()}
window.ias=function(a){function b(r){var n={};if(r!=j)for(var D in r){var E=r[D];if(E!=j)n[D]=E}return n}function d(r){p=b(r);C.push(p);u=j}function g(r,n){if(n!=j)B[r]=n;else delete B[r];H=j}function h(r,n){return encodeURIComponent(r)+"="+encodeURIComponent(n)}function v(r,n){return encodeURIComponent(r)+(n==""?"":"="+encodeURIComponent(n))}function A(r,n){var D=n?v:h,E=[],N;for(N in r){var z=r[N];if(z&&z.push&&z.sort)for(var m=0;m<z.length;++m)E.push(D(N,z[m]));else z!=j&&E.push(D(N,z))}return E.join(";")}
var j=null,q=j,u=j,p={},C=[p],B={},H=j,J=[],P=[],y=window.ias||{};y.SetNamespace=function(r){q=r};y.SetContext=function(r){p=b(r);C[C.length-1]=p;u=j};y.SetContextPart=function(r,n){if(n!=j)p[r]=n;else delete p[r];u=j};y.ResetContext=function(r){C=[];d(r)};y.SetTag=g;y.SetTags=function(r){for(var n in r)g(n,r[n])};y.ResetTags=function(r){B=b(r);H=j};y.PushContext=d;y.PopContext=function(){C.pop();C.length||C.push({});p=C[C.length-1];u=j};y.AddDiscoveryCddUrl=function(r){J.push(r)};y.AddApplicableCddUrl=
function(r){P.push(r)};a.UPK_GetNamespace=function(){return q};a.UPK_GetContext=function(){if(u==j)u=A(p);return u};a.UPK_GetTags=function(){if(H==j)H=A(B,true);return H};a.UPK_GetDiscoveryCddUrls=function(){return J.length?J:j};a.UPK_GetApplicableCddUrls=function(){return P.length?P:j};return y}(window);ias.SetTag("upk-trait-nohelp","");upk=upk||{};
$.extend(true,upk,{contextHelper:function(){var a=null,b,d;this.SetContext=function(h,v){if(a)a.SetContext(h,v);else{d=b;b={view:h,subview:v};ias.SetContext(b)}};this.SetNamespace=function(h){a||ias.SetNamespace(h)};this.AddDiscoveryCddUrl=function(h){a||ias.AddDiscoveryCddUrl(h)};this.SetPrevContext=function(){if(a)a.SetPrevContext();else{b=d;ias.SetContext(b)}};try{if(self!=top&&typeof parent.ctxHelper==="object")a=parent.ctxHelper}catch(g){}return this}});window.ctxHelper=new upk.contextHelper;
function UserPreferences(){this.EnablePreferences=true;this.TimeStamp="000000000000";this.ShowLeadIn=this.PlayAudio="all";this.MarqueeColor="red";this.TryIt={};this.TryIt.EnableSkipping=true;this.DoIt={};this.DoIt.HotKey={};this.DoIt.HotKey.Ctrl="L";this.DoIt.HotKey.Shift="N";this.DoIt.HotKey.Alt="L";this.DefaultPlayMode="S";this.WebPageAutoPlayback=true;this.ApplicableOutlineDisplay="L";this.NavbarVolume=100;this.EnableShowDiagnostics=false}
UserPreferences.prototype.Copy=function(a){this.TimeStamp=a.TimeStamp;this.PlayAudio=a.PlayAudio;this.ShowLeadIn=a.ShowLeadIn;this.MarqueeColor=a.MarqueeColor;this.TryIt.EnableSkipping=a.TryIt.EnableSkipping;this.DoIt.HotKey.Ctrl=a.DoIt.HotKey.Ctrl;this.DoIt.HotKey.Shift=a.DoIt.HotKey.Shift;this.DoIt.HotKey.Alt=a.DoIt.HotKey.Alt;this.DefaultPlayMode=a.DefaultPlayMode;this.WebPageAutoPlayback=a.WebPageAutoPlayback;this.ApplicableOutlineDisplay=a.ApplicableOutlineDisplay;this.NavbarVolume=a.NavbarVolume;
this.EnableShowDiagnostics=a.EnableShowDiagnostics};
UserPreferences.prototype.Compare=function(a){if(this.PlayAudio!=a.PlayAudio)return true;if(this.ShowLeadIn!=a.ShowLeadIn)return true;if(this.MarqueeColor!=a.MarqueeColor)return true;if(this.TryIt.EnableSkipping!=a.TryIt.EnableSkipping)return true;if(this.DoIt.HotKey.Ctrl!=a.DoIt.HotKey.Ctrl)return true;if(this.DoIt.HotKey.Shift!=a.DoIt.HotKey.Shift)return true;if(this.DoIt.HotKey.Alt!=a.DoIt.HotKey.Alt)return true;if(this.DefaultPlayMode!=a.DefaultPlayMode)return true;if(this.WebPageAutoPlayback!=
a.WebPageAutoPlayback)return true;if(this.ApplicableOutlineDisplay!=a.ApplicableOutlineDisplay)return true;if(this.NavbarVolume!=a.NavbarVolume)return true;if(this.EnableShowDiagnostics!=a.EnableShowDiagnostics)return true;return false};UserPreferences.prototype.GetCookie=function(){return new Cookie(document,"OnDemandPlayer",365,"/",null,false)};
UserPreferences.prototype.LoadCookie=function(){var a=this.GetCookie();a.Load();if(a.PlayAudio)this.PlayAudio=a.PlayAudio;UserPref_PlayAudio_Original=this.PlayAudio;if(upk.browserInfo.isSoundSupported()==false)this.PlayAudio="none";if(!(UserPrefs.TimeStamp!="000000000000"&&(!a.TimeStamp||UserPrefs.TimeStamp>a.TimeStamp))){if(a.ShowLeadIn)this.ShowLeadIn=a.ShowLeadIn;if(a.MarqueeColor)this.MarqueeColor=a.MarqueeColor;if(a.TryIt_EnableSkipping)this.TryIt.EnableSkipping=a.TryIt_EnableSkipping=="true";
if(a.DoIt_HotKey_Ctrl)this.DoIt.HotKey.Ctrl=a.DoIt_HotKey_Ctrl;if(a.DoIt_HotKey_Shift)this.DoIt.HotKey.Shift=a.DoIt_HotKey_Shift;if(a.DoIt_HotKey_Alt)this.DoIt.HotKey.Alt=a.DoIt_HotKey_Alt;if(a.DefaultPlayMode)this.DefaultPlayMode=a.DefaultPlayMode;if(a.WebPageAutoPlayback)this.WebPageAutoPlayback=a.WebPageAutoPlayback;if(a.ApplicableOutlineDisplay)this.ApplicableOutlineDisplay=a.ApplicableOutlineDisplay;if(a.NavbarVolume)this.NavbarVolume=a.NavbarVolume;if(a.EnableShowDiagnostics)this.EnableShowDiagnostics=
a.EnableShowDiagnostics=="true"}};
UserPreferences.prototype.StoreCookie=function(){var a=this.GetCookie();a.TimeStamp=this.TimeStamp;a.PlayAudio=this.PlayAudio;a.ShowLeadIn=this.ShowLeadIn;a.MarqueeColor=this.MarqueeColor;a.TryIt_EnableSkipping=this.TryIt.EnableSkipping;a.DoIt_HotKey_Ctrl=this.DoIt.HotKey.Ctrl;a.DoIt_HotKey_Shift=this.DoIt.HotKey.Shift;a.DoIt_HotKey_Alt=this.DoIt.HotKey.Alt;a.DefaultPlayMode=this.DefaultPlayMode;a.WebPageAutoPlayback=this.WebPageAutoPlayback;a.ApplicableOutlineDisplay=this.ApplicableOutlineDisplay;
a.NavbarVolume=this.NavbarVolume;a.EnableShowDiagnostics=this.EnableShowDiagnostics;a.Store()};UserPreferences.prototype.GetUrlParamString=function(){return"PP_SOUND="+this.PlayAudio+"&PP_LEADIN="+this.ShowLeadIn+"&PP_SKIP="+(this.TryIt.EnableSkipping?"true":"false")+"&PP_MARQUEE="+this.MarqueeColor+"&PP_ENABLE="+(this.EnablePreferences?"true":"false")+"&PP_HOTKEY="+this.DoIt.HotKey.Ctrl+this.DoIt.HotKey.Shift+this.DoIt.HotKey.Alt};
UserPreferences.prototype.ParseUrlParamString=function(a){a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].split("=");if(d[0].toUpperCase()=="PP_SOUND")this.PlayAudio=d[1];else if(d[0].toUpperCase()=="PP_LEADIN")this.ShowLeadIn=d[1];else if(d[0].toUpperCase()=="PP_MARQUEE")this.MarqueeColor=d[1];else if(d[0].toUpperCase()=="PP_SKIP")this.TryIt.EnableSkipping=d[1]=="true";else if(d[0].toUpperCase()=="PP_ENABLE")this.EnablePreferences=d[1]=="true";else if(d[0].toUpperCase()=="PP_HOTKEY"){this.DoIt.HotKey.Ctrl=
d[1].charAt(0);this.DoIt.HotKey.Shift=d[1].charAt(1);this.DoIt.HotKey.Alt=d[1].charAt(2)}}};var UserPrefs=new UserPreferences,UserPref_PlayAudio_Original="";typeof SetDefaultPreferences!=="undefined"&&SetDefaultPreferences();UserPrefs.EnablePreferences&&UserPrefs.LoadCookie();var paramstr=unescape(document.location.hash.substring(1));if(paramstr=="")paramstr=unescape(document.location.search.substring(1));UserPrefs.ParseUrlParamString(paramstr);
function OpenPreferencesDialog(a,b){if(UserPrefs.EnablePreferences){var d=a+"/html/preferences.html",g;g=upk.browserInfo.isChrome()?430:upk.browserInfo.isFF()?420:upk.browserInfo.isSafari()?350:412;var h=[];try{if(lms_IsUserProfileAvailable()){var v=lms_GetUserProfileUrl();if(v!="")h[h.length]="UserProfileUrl="+Escape.MyEscape(v)}}catch(A){}if(b)h[h.length]="nosound";for(v=0;v<h.length;v++){d+=v==0?"?":"&";d+=h[v]}if(IsTouchDevice()||upk.browserInfo.isIE10Modern()){g+=50;showDialog(d,-1,-1,400,g,
true,96,"../../../",false)}else window.open(d,"prefwin","width=500,height="+g+",resizable=1,scrollbars=0,top="+(screen.availHeight-290)/2+",left="+(screen.availWidth-500)/2)}else alert(R_preferences_disabled)}function SessionPreferences(){this.swipeInstructionShowed=false}SessionPreferences.prototype.GetCookie=function(){return new Cookie(document,"OnDemandPlayerSession",null,"/")};
SessionPreferences.prototype.LoadCookie=function(){var a=this.GetCookie();a.Load();if(a.swipeInstructionShowed)this.swipeInstructionShowed=a.swipeInstructionShowed};SessionPreferences.prototype.StoreCookie=function(){var a=this.GetCookie();a.swipeInstructionShowed=this.swipeInstructionShowed;a.Store()};var SessionPrefs=new SessionPreferences;
function GetContentPathName(){var a=window.location.pathname,b=a.indexOf("data/toc.html");if(b>0)return a.substr(0,b);b=a.indexOf("html/roles.html");if(b>0)return a.substr(0,b);b=a.indexOf("data/tpc/");if(b>0)return a.substr(0,b);b=a.indexOf("html/lmsui.html");if(b>0)return a.substr(0,b);return a}function UserRolesClass(){this.Filtering=false;this.Roles=[]}UserRolesClass.prototype.Copy=function(a){this.Filtering=a.Filtering;this.Roles=[];for(var b=0;b<a.Roles.length;b++)this.Roles[b]=a.Roles[b]};
UserRolesClass.prototype.Compare=function(a){if(this.Filtering!=a.Filtering)return true;if(this.Roles.length!=a.Roles.length)return true;for(var b=0;b<this.Roles.length;b++)if(this.Roles[b]!=a.Roles[b])return true;return false};UserRolesClass.prototype.GetCookie=function(){return new Cookie(document,"OnDemandPlayerRoles",90,GetContentPathName(),null,false)};
UserRolesClass.prototype.LoadCookie=function(){var a=this.GetCookie();a.Load();this.Filtering=false;if(a.Filtering)this.Filtering=a.Filtering=="true";this.Roles=[];if(a.Roles)this.Roles=a.Roles.split("+")};UserRolesClass.prototype.StoreCookie=function(){var a=this.GetCookie();a.Filtering=this.Filtering?"true":"false";a.Roles=this.Roles.join("+");a.Store()};UserRolesClass.prototype.GetUrlParamString=function(){return"PP_ROLEFILTERING="+(this.Filtering?"true":"false")+"&PP_ROLES="+encodeURIComponent(this.Roles.join("+"))};
UserRolesClass.prototype.ParseUrlParamString=function(a){a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].split("=");if(d[0].toUpperCase()=="PP_ROLEFILTERING")this.Filtering=d[1]=="true";else if(d[0].toUpperCase()=="PP_ROLES"){this.Roles=[];if(d[1])this.Roles=d[1].split("+")}}};var UserRoles=new UserRolesClass;UserRoles.LoadCookie();UserRoles.ParseUrlParamString(paramstr);
function OpenRolesDialog(a){window.open(a+"/html/roles.html","roleswin","width=500,height=318,resizable=1,scrollbars=0,top="+(screen.availHeight-286)/2+",left="+(screen.availWidth-500)/2)}var bSoundIsAvailable=true,bSeeItOnly=false,bFlashInstalled=true,Orig_UserPrefs=new UserPreferences;Orig_UserPrefs.Copy(UserPrefs);var bIsModified=false;function GetOpener(){if(parent.opener)return parent.opener;if(parent.parent)if(parent.parent.opener)return parent.parent.opener;return 0}
function SetModified(a){if(a!=bIsModified){bIsModified=a;document.controlform.Apply.disabled=!a}}function UpdateModified(){bIsModified||SetModified(UserPrefs.Compare(Orig_UserPrefs))}
function UpdateForm(){$("#PlayAudio select").val(UserPrefs.PlayAudio);document.prefform.LeadInSelect.checked=UserPrefs.ShowLeadIn!="toc";document.prefform.TryItEnableSkipping.checked=UserPrefs.TryIt.EnableSkipping;$("#MarqueeColor div").css("background-color",UserPrefs.MarqueeColor);bFlashInstalled||$("#PlayAudio select").attr("disabled","disabled");$("#HotKeyCtrl").val(UserPrefs.DoIt.HotKey.Ctrl);$("#HotKeyShift").val(UserPrefs.DoIt.HotKey.Shift);$("#HotKeyAlt").val(UserPrefs.DoIt.HotKey.Alt);if(Debug.EnableShowDiagnostics==
false)$("#ShowDiag").parent().hide();else document.prefform.ShowDiag.checked=UserPrefs.EnableShowDiagnostics;$("#DefPlayMode").val(UserPrefs.DefaultPlayMode)}
function DoApply(){if(bIsModified){SetModified(false);var a=UserPrefs.GetCookie();a.TimeStamp=UserPrefs.TimeStamp;a.PlayAudio=UserPrefs.PlayAudio;a.ShowLeadIn=UserPrefs.ShowLeadIn;a.MarqueeColor=UserPrefs.MarqueeColor;a.TryIt_EnableSkipping=UserPrefs.TryIt.EnableSkipping;a.DoIt_HotKey_Ctrl=UserPrefs.DoIt.HotKey.Ctrl;a.DoIt_HotKey_Shift=UserPrefs.DoIt.HotKey.Shift;a.DoIt_HotKey_Alt=UserPrefs.DoIt.HotKey.Alt;a.EnableShowDiagnostics=UserPrefs.EnableShowDiagnostics;a.DefaultPlayMode=UserPrefs.DefaultPlayMode;
a.Store();if(a=GetOpener())if(a.OnUpdatePreferences)a.OnUpdatePreferences(UserPrefs);else a.UserPrefs&&a.UserPrefs.Copy(UserPrefs);Orig_UserPrefs.Copy(UserPrefs)}}function ResetDefaults_onclick(){if(confirm(R_default_prefs)){UserPrefs=new UserPreferences;window.SetDefaultPreferences&&SetDefaultPreferences();if(bFlashInstalled==false)UserPrefs.PlayAudio="none";UpdateForm();UpdateModified()}}
function TryItEnableSkipping_onclick(){UserPrefs.TryIt.EnableSkipping=document.prefform.TryItEnableSkipping.checked;UpdateModified()}function LeadInSelect_onclick(){UserPrefs.ShowLeadIn=document.prefform.LeadInSelect.checked?"all":"toc";UpdateModified()}function PlayAudio_onchange(){UserPrefs.PlayAudio=$("#PlayAudio select").val();UpdateModified()}function HotKey_Ctrl_onchange(){UserPrefs.DoIt.HotKey.Ctrl=$("#HotKeyCtrl").val();UpdateModified()}
function HotKey_Shift_onchange(){UserPrefs.DoIt.HotKey.Shift=$("#HotKeyShift").val();UpdateModified()}function HotKey_Alt_onchange(){UserPrefs.DoIt.HotKey.Alt=$("#HotKeyAlt").val();UpdateModified()}function DefPlayMode_onchange(){UserPrefs.DefaultPlayMode=$("#DefPlayMode").val();UpdateModified()}function OnColorSelection(a){UserPrefs.MarqueeColor=a;$("#MarqueeColor div").css("background-color",UserPrefs.MarqueeColor);UpdateModified()}function ChangeColor_onclick(){ShowColorTable()}
function ShowDiag_onclick(){UserPrefs.EnableShowDiagnostics=document.prefform.ShowDiag.checked;UpdateModified()}
function init_ui_elements(){$("[name='prefform'] .PrefTextHead").text(R_preferences_options);$("#MarqueeColor span").html(R_preferences_marquee);$("input[name='ChangeColor']").attr({value:R_preferences_changecolor,title:R_preferences_changecolor_title});$("#PlayAudio label").html(R_preferences_playaudio);$("#PlayAudio").attr("title",R_preferences_audiotooltip);$("#PlayAudio option[value='none']").text(R_preferences_nosound);$("#PlayAudio option[value='demo']").text(R_preferences_keyboardsound);$("#PlayAudio option[value='all']").text(R_preferences_allsound);
$("#FlashText span").text(R_preferences_flash);$("#LeadInSelect").attr("title",R_preferences_showintroduction2).siblings("label[for='LeadInSelect']").attr("title",R_preferences_leadintooltip).text(R_preferences_showintroduction);$("#TryItEnableSkipping").attr("title",R_preferences_tryitenableskipping2).siblings("label[for='TryItEnableSkipping']").attr("title",R_preferences_skippingtooltip).text(R_preferences_tryitenableskipping);$("#keyCombinationsInDoIt").text(R_preferences_doitcombinations);$("#HotKeyCtrl").attr("title",
R_preferences_ctrltooltip);$("#HotKeyCtrl option[value='L']").text(R_preferences_Lctrl);$("#HotKeyCtrl option[value='R']").text(R_preferences_Rctrl);$("#HotKeyCtrl option[value='N']").text(R_preferences_Nctrl);$("#HotKeyShift").attr("title",R_preferences_shifttooltip);$("#HotKeyShift option[value='L']").text(R_preferences_Lshift);$("#HotKeyShift option[value='R']").text(R_preferences_Rshift);$("#HotKeyShift option[value='N']").text(R_preferences_Nshift);$("#HotKeyAlt").attr("title",R_preferences_alttooltip);
$("#HotKeyAlt option[value='L']").text(R_preferences_Lalt);$("#HotKeyAlt option[value='R']").text(R_preferences_Ralt);$("#HotKeyAlt option[value='N']").text(R_preferences_Nalt);$("#note1").text(R_preferences_note);$("#note2").text(R_preferences_note_text);$("#DefPlayModeLabel").text(R_preferences_defplaymode);$("#DefPlayMode option[value='S']").text(R_mode_seeit);$("#DefPlayMode option[value='T']").text(R_mode_tryit);$("#DefPlayMode option[value='K']").text(R_mode_knowit);$("#DefPlayMode option[value='D']").text(R_mode_doit);
$("#DefPlayModeLabel2").text(R_preferences_defplaymodetext);$("#ShowDiag").attr("title",R_preferences_showdiagnostics).siblings("label[for='ShowDiag']").attr("title",R_preferences_showdiagnostics).text(R_preferences_showdiagnostics);$("input[name='ResetDefaults']").attr({value:R_preferences_defaults,title:R_preferences_defaults_title});upk.browserInfo.isFF()&&$("input[type='button']").addClass("InstructTextButtonFF");$("input[name='OK']").attr("value",R_preferences_OK);$("input[name='Cancel']").attr("value",
R_preferences_cancel);$("input[name='Apply']").attr("value",R_preferences_apply);$("input[name='Help']").attr("value",R_preferences_help)}function DisableComboBoxes(){upk.browserInfo.isSafari()||$("#prefmain :input").attr("disabled","disabled")}function EnableComboBoxes(){if(!upk.browserInfo.isSafari()){$("#prefmain :input").removeAttr("disabled");bFlashInstalled||$("#PlayAudio select").attr("disabled","disabled")}}
function CheckFlash(){if(upk.browserInfo.isSoundSupported()){$("#FlashText").css("display","none");bFlashInstalled=true}else{bFlashInstalled=false;UserPrefs.PlayAudio="none";Orig_UserPrefs.PlayAudio="none";$("#PlayAudio select").val(UserPrefs.PlayAudio).attr("disabled","disabled")}}function Apply_onclick(){DoApply()}function OK_onclick(){Apply_onclick();close();parent.closeDialog&&parent.closeDialog()}function Cancel_onclick(){close();parent.closeDialog&&parent.closeDialog()}
function ShowColorTable(){DisableComboBoxes();document.getElementById("preftrp").style.display="inline";document.getElementById("prefcolor").style.display="inline";frames.prefcolor.focus()}function ColorSelected(a){OnColorSelection(a);HideColorTable()}function HideColorTable(){document.getElementById("preftrp").style.display="none";document.getElementById("prefcolor").style.display="none";EnableComboBoxes()}function Click(){HideColorTable()}
function InitPreferences(){document.title=R_preferences_title;var a="",b=document.location.hash.substring(1).split("&");if(b.length==0||b[0]=="")b=document.location.search.substring(1).split("&");if(b.length>0)for(var d=0;d<b.length;d++){var g=b[d];if(g.toUpperCase()=="NOSOUND")bSoundIsAvailable=false;if(g.toUpperCase()=="SEEITONLY")bSeeItOnly=true;if(g.toUpperCase().substr(0,15)=="USERPROFILEURL=")a=Escape.MyUnEscape(g.substr(15))}document.getElementById("prefTabButton").innerHTML=R_preferences_title;
if(a!=""){document.getElementById("profileTabId").style.display="block";document.getElementById("profileTabButton").innerHTML=R_userprofile_title;frames.profileFrame.location.replace(a)}bSeeItOnly&&$(".hidebyseeit").hide();UpdateForm();$(".PrefControls").css("display","block");window.focus();init_ui_elements()}function window_onunload2(){try{opener&&opener.OnClosingPreferences&&opener.OnClosingPreferences()}catch(a){}}$(function(){$("#prefTabs").tabs();CheckFlash();InitPreferences()});

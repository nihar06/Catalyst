/*
Copyright © 1998, 2014, Oracle and/or its affiliates.  All rights reserved.
*/
var intPos=window.location.search.toLowerCase().indexOf("aicc_url"),intPos2=window.location.search.toLowerCase().indexOf("aicc_sid");function getOnlyPath(a){for(;a.indexOf("\\")!=-1;)a=a.replace("\\","/");return a.substr(0,a.lastIndexOf("/"))}
if(intPos>-1&&intPos2>-1){if(LmsConfig.AiccAppletPath==""){var currentPgPath=window.location.protocol+"//"+window.location.host+getOnlyPath(window.location.pathname);fullPath=currentPgPath+"/"+lms_path+"aicc"}else fullPath=LmsConfig.AiccAppletPath;document.write("<div style='position: absolute;'><applet NAME='GetHTTPPostData' codebase='"+fullPath+"' archive='gethttppostdata.jar' code='GetHTTPPostData' width='1' height='1' MAYSCRIPT><param name='permissions' value='sandbox' /></applet></div>")}
function InsertRuntimeAPI(a){if(Kpath_launch==false)setTimeout(a,1);else{var b=findKPathAPIFrame(window);if(b==null){b=document.createElement("iframe");b.id="KPATH_API_FRAME";b.style.display="none";document.body.appendChild(b);if(a)if(navigator.appName=="Microsoft Internet Explorer")b.attachEvent("onload",a);else b.onload=a;b.src=Kpath_Runtime_API}else setTimeout(a,1)}}
function findKPathAPIFrame(a){var b=null,c=0,d=a;try{for(;d!=null;){b=d.document.getElementById("KPATH_API_FRAME");if(b!=null)return b.contentWindow;c++;if(c>7)break;if(d===d.parent)break;d=d.parent}if(a.top.opener!=null)return findKPathAPIFrame(a.top.opener)}catch(e){}return null}var _GlobalLmsComFactory=null;function GetLmsComFactory(){_GlobalLmsComFactory==null&&alert(R_initializelmscom_not_called);return _GlobalLmsComFactory}
function CheckForLMSAPI(){if(_lmsMode=="LMS"&&!(_GlobalLmsComFactory.api_type=="scorm2004"||_GlobalLmsComFactory.api_type=="scorm12"||_GlobalLmsComFactory.api_type=="aicc"||_GlobalLmsComFactory.api_type=="kpath"&&findKPathAPIFrame(window)))alert(R_scorm_noapi);_lmsMode=="KPT"&&!findKPathAPIFrame(window)&&alert(R_scorm_noapi)}function InitializeLmsCom(){_GlobalLmsComFactory=new LmsComFactory(window.location.search)}
function LmsComFactory(a){this.api_type="none";this.launch_arg=a;this.aicc_sid=this.aicc_url="";this.scorm_api_2004=this.scorm_api_12=null;a=this.launch_arg.substring(1).split("&");lmslog.addEntry(0,"LmsComFactory","strArgs",a);for(var b=0;b<a.length;b++){strArg=a[b];var c;c=this.CheckParam(strArg,"aicc_url=");if(c!="")this.aicc_url=c.substr(0,4).toLowerCase()!="http"?LmsConfig.AiccUrlProtocol+c:c;else{c=this.CheckParam(strArg,"aicc_sid=");if(c!="")this.aicc_sid=c}}if(LmsConfig.ScormVersion!=="1.2")this.scorm_api_2004=
this.FindScorm2004API();if(this.scorm_api_2004==null&&LmsConfig.ScormVersion!=="2004")this.scorm_api_12=this.FindScorm12API();if(this.aicc_url!=""&&this.aicc_sid!="")this.api_type="aicc";else if(Kpath_launch==true)this.api_type="kpath";else if(this.scorm_api_2004!=null)this.api_type="scorm2004";else if(this.scorm_api_12!=null)this.api_type="scorm12"}
LmsComFactory.prototype.CreateLmsCom=function(){if(this.api_type=="aicc")return new LmsComAICC(this.aicc_url,this.aicc_sid);else if(this.api_type=="scorm2004")return new LmsComScorm2004;else if(this.api_type=="kpath"){var a=new LmsComKPath;a.API=this.scorm_api_2004;return a}else if(this.api_type=="scorm12")return new LmsComScorm12;return PlayerConfig.EnableCookies?new LmsComCookie:new LmsComBase};
LmsComFactory.prototype.FindScorm12API=function(){try{var a=this.FindWindowScorm12API(window);if(a==null&&top.window.opener!=null&&!top.window.opener.closed)a=this.FindWindowScorm12API(top.window.opener);return a}catch(b){return null}};LmsComFactory.prototype.FindWindowScorm12API=function(a){for(var b=0;a.API==null&&a.parent!=null&&a.parent!=a;){b++;if(b>500){lmslog.addEntry(0,"FindScorm12API","",R_scorm_apideep);return null}a=a.parent}return a.API};
LmsComFactory.prototype.FindScorm2004API=function(){try{var a=this.FindWindowScorm2004API(window);if(a==null&&top.window.opener!=null&&!top.window.opener.closed)a=this.FindWindowScorm2004API(top.window.opener);return a}catch(b){return null}};LmsComFactory.prototype.FindWindowScorm2004API=function(a){for(var b=0;a.API_1484_11==null&&a.parent!=null&&a.parent!=a;){b++;if(b>500){lmslog.addEntry(0,"FindScorm2004API","",R_scorm_apideep);return null}a=a.parent}return a.API_1484_11};
LmsComFactory.prototype.CheckParam=function(a,b){var c=b.length,d="";if(a.substr(0,c).toLowerCase()==b)d=a.substring(c);return d};var LMS_PASSED="passed",LMS_FAILED="failed",LMS_COMPLETED="completed",LMS_INCOMPLETE="incomplete",LMS_NOT_ATTEMPTED="not attempted";Date.prototype.toSCORM=function(){return this.getFullYear()+"-"+("0"+(this.getMonth()+1)).slice(-2)+"-"+("0"+this.getDate()).slice(-2)+"T"+("0"+this.getHours()).slice(-2)+":"+("0"+this.getMinutes()).slice(-2)+":"+("0"+this.getSeconds()).slice(-2)};
function LmsComBase(a){this.status_obj=null;this.ordinal_number=0;this.credit=this.student_name=this.student_id=this.end_date=this.start_date="";this.lesson_status=LMS_NOT_ATTEMPTED;this.time=this.score=this.core_vendor=this.original_lesson_data=this.lesson_data=this.lesson_location=this.lesson_flag="";this.doit_child_time=this.mode_idle_time=this.idle_time=0;this.guid=this.owner=null;this.isTestIt=this.bigsco=this.session_active=false;if(a!=null){this.Copy(a);this.ParentLmsCom=a}this.object_type_name=
"LmsComBase"}LmsComBase.prototype.GetOrdinalNumber=function(){return this.ordinal_number};LmsComBase.prototype.SetOrdinalNumber=function(a){this.ordinal_number=a};LmsComBase.prototype.Copy=function(a){this.student_id=a.student_id;this.student_name=a.student_name;this.credit=a.credit;this.lesson_status=a.lesson_status;this.bigsco=a.bigsco;this.lesson_data=a.lesson_data;this.lesson_location=a.lesson_location};
LmsComBase.prototype.Begin=function(){this.start_date=(new Date).getTime();this.session_active&&alert(R_lmscom_already_active);return this.session_active=true};LmsComBase.prototype.End=function(){this.session_active||alert(R_lmscom_inactive);this.end_date=(new Date).getTime();this.session_active=false;return true};LmsComBase.prototype.LoadAPIAdapter=function(a){a()};LmsComBase.prototype.SendCompletionInfo=function(){};
LmsComBase.prototype.NotifyParent=function(){var a=this.ParentLmsCom;a&&!a.owner.closed&&a.owner.ListenChildClose&&a.owner.ListenChildClose()};LmsComBase.prototype.getReportedLessonStatus=function(){return this.lesson_status===LMS_PASSED?LmsConfig.ReportOnPass:this.lesson_status===LMS_FAILED?LmsConfig.ReportOnFail:this.lesson_status};LmsComBase.prototype.computeTime=function(a,b){return this.convertTotalSeconds((b-a-this.idle_time)/1E3)};
LmsComBase.prototype.computeTime2=function(a,b){return""+(b.getTime()-a-this.doit_child_time)/1E3};LmsComBase.prototype.convertTotalSeconds=function(a){var b=a%60;a-=b;var c=a%3600;a-=c;b=Math.round(b*100)/100;var d=b=new String(b);if(b.indexOf(".")!=-1){d=b.substring(0,b.indexOf("."));b.substring(b.indexOf(".")+1,b.length)}if(d.length<2)d="0"+d;b=d;a=a%3600!=0?0:a/3600;c=c%60!=0?0:c/60;if((new String(a)).length<2)a="0"+a;if((new String(c)).length<2)c="0"+c;return a+":"+c+":"+b};
LmsComBase.prototype.doGetUPKValue=function(a){if(this.ParentLmsCom)return this.ParentLmsCom.doGetUPKValue(a);return""};LmsComBase.prototype.doSetUPKValue=function(a,b){this.ParentLmsCom&&this.ParentLmsCom.doSetUPKValue(a,b)};LmsComBase.prototype.doUPKCommit=function(){this.ParentLmsCom&&this.ParentLmsCom.doUPKCommit()};LmsComBase.prototype.setInteraction=function(a,b){if(this.ParentLmsCom)return this.ParentLmsCom.setInteraction(a,b)};
LmsComBase.prototype.getAnsweredQuestions=function(){if(this.ParentLmsCom)return this.ParentLmsCom.getAnsweredQuestions();return{}};LmsComBase.prototype.setObjective=function(a,b){this.ParentLmsCom&&this.ParentLmsCom.setObjective(a,b)};LmsComBase.prototype.requestContinue=function(){this.ParentLmsCom&&this.ParentLmsCom.requestContinue()};LmsComBase.prototype.IsConnected=function(){if(this.ParentLmsCom)return this.ParentLmsCom.IsConnected();return false};
LmsComBase.prototype.OpenBasicStatus=function(){this.status_obj=new LmsBasicStatus;this.status_obj.status=this.lesson_status;return this.status_obj};
LmsComBase.prototype.OpenTopicStatus=function(a,b,c){this.status_obj=new LmsTopicStatus;this.status_obj.setRequiredMode(a,b,c);lmslog.addEntry(0,"OpenTopicStatus","RequiredMode",this.status_obj.requiredMode);this.status_obj.isScored=!!a.K;a=GetTopLevelLmsMode()=="LMS"?a:b;this.status_obj.setModeavail("S",a.S);this.status_obj.setModeavail("T",a.T);this.status_obj.setModeavail("K",a.K);this.status_obj.setModeavail("D",a.D);this.status_obj.setModeavail("P",a.P);this.status_obj.setModeavail("E",a.E);
lmslog.addEntry(0,"OpenTopicStatus","SeeIt",this.status_obj.getModeavail("S"));lmslog.addEntry(0,"OpenTopicStatus","TryIt",this.status_obj.getModeavail("T"));lmslog.addEntry(0,"OpenTopicStatus","KnowIt",this.status_obj.getModeavail("K"));lmslog.addEntry(0,"OpenTopicStatus","DoIt",this.status_obj.getModeavail("D"));lmslog.addEntry(0,"OpenTopicStatus","PrintIt",this.status_obj.getModeavail("P"));lmslog.addEntry(0,"OpenTopicStatus","TestIt",this.status_obj.getModeavail("E"));if(this.bigsco){this.status_obj.savedStatus=
this.lesson_data.charAt(0);this.lesson_data=this.lesson_data.substring(1)}this.status_obj.initTopicstat(this.lesson_data);return this.status_obj};
LmsComBase.prototype.OpenTopicLaunchStatus=function(a,b,c,d){this.status_obj=new LmsTopicLaunchStatus(a);this.status_obj.setRequiredMode(b,c,d);lmslog.addEntry(0,"OpenTopicLaunchStatus","RequiredMode",this.status_obj.requiredMode);this.status_obj.isScored=b.indexOf("K")!=-1;a=GetTopLevelLmsMode()=="LMS"?b:c;this.status_obj.setModeavail("S",a.indexOf("S")!=-1);this.status_obj.setModeavail("T",a.indexOf("T")!=-1);this.status_obj.setModeavail("K",a.indexOf("K")!=-1);this.status_obj.setModeavail("D",
a.indexOf("D")!=-1);this.status_obj.setModeavail("P",a.indexOf("P")!=-1);this.status_obj.setModeavail("E",a.indexOf("E")!=-1);lmslog.addEntry(0,"OpenTopicLaunchStatus","SeeIt",this.status_obj.getModeavail("S"));lmslog.addEntry(0,"OpenTopicLaunchStatus","TryIt",this.status_obj.getModeavail("T"));lmslog.addEntry(0,"OpenTopicLaunchStatus","KnowIt",this.status_obj.getModeavail("K"));lmslog.addEntry(0,"OpenTopicLaunchStatus","DoIt",this.status_obj.getModeavail("D"));lmslog.addEntry(0,"OpenTopicLaunchStatus",
"PrintIt",this.status_obj.getModeavail("P"));lmslog.addEntry(0,"OpenTopicLaunchStatus","TestIt",this.status_obj.getModeavail("E"));this.status_obj.initTopicstat(this.lesson_data);return this.status_obj};LmsComBase.prototype.OpenQuestionStatus=function(){this.status_obj=new LmsQuestionStatus;this.status_obj.status=LMS_NOT_ATTEMPTED;this.status_obj.savedStatus=this.lesson_data?Stat2Lms(this.lesson_data):LMS_NOT_ATTEMPTED;return this.status_obj};
LmsComBase.prototype.OpenAssessmentStatus=function(a,b,c){this.status_obj=new LmsAssessmentStatus;this.status_obj.hash=b;this.status_obj.questionlimit=c;var d=this.lesson_data,e,f=null,h=-1;if(d)if(this.bigsco)f=b;else{var g=d.indexOf("@");if(g>0){e=parseInt(d.substring(0,g));f=d.substring(g+1,g+e+1).replace(/ /g,"+");d=d.substring(g+e+1);g=d.indexOf("@");if(g>0){e=parseInt(d.substring(0,g));h=parseInt(d.substring(g+1,g+e+1));d=d.substring(g+e+1)}}}if(b===f&&d.length===a+1&&c===h){this.status_obj.savedStatus=
d.charAt(0);this.status_obj.status=d.charAt(0)==="I"?LMS_INCOMPLETE:LMS_NOT_ATTEMPTED;for(b=0;b<a;b++)this.status_obj.questionstatus[b]=d.charAt(b+1)}else{if(d&&!this.bigsco){this.status_obj.stateDiscarded=true;this.status_obj.savedStatus=d.charAt(0)==="I"?"N":d.charAt(0)}else this.status_obj.savedStatus="N";this.status_obj.status=LMS_NOT_ATTEMPTED;for(b=0;b<a;b++)this.status_obj.questionstatus[b]="N"}return this.status_obj};
LmsComBase.prototype.OpenTOCStatus=function(a,b){var c=new LmsTOCStatus;this.status_obj=c;var d=new TOCState(a,b);c.setTocState(d);this.lesson_data!=null&&this.lesson_data.length>0&&d.DeserializeTOC(this.lesson_data);return c};LmsComBase.prototype.SaveStatus=function(){this.status_obj&&this.status_obj.Save(this)};LmsComBase.prototype.utGetModeIndex=function(){this.ParentLmsCom&&this.ParentLmsCom.utGetModeIndex()};LmsComBase.prototype.utPushModeIndex=function(){this.ParentLmsCom&&this.ParentLmsCom.utPushModeIndex()};
LmsComBase.prototype.utPopModeIndex=function(){this.ParentLmsCom&&this.ParentLmsCom.utPopModeIndex()};LmsComBase.prototype.utRecordType=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordType(a)};LmsComBase.prototype.utRecordStartTime=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordStartTime(a)};LmsComBase.prototype.utRecordTimespan=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordTimespan(a)};LmsComBase.prototype.utRecordEndTime=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordEndTime(a)};
LmsComBase.prototype.utRecordCompletionStatus=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordCompletionStatus(a)};LmsComBase.prototype.utRecordSuccessStatus=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordSuccessStatus(a)};LmsComBase.prototype.utRecordScoreScaled=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordScoreScaled(a)};LmsComBase.prototype.utRecordFrameViewed=function(a){this.ParentLmsCom&&this.ParentLmsCom.utRecordFrameViewed(a)};
LmsComBase.prototype.utSendTestItResult=function(a){this.ParentLmsCom&&this.ParentLmsCom.utSendTestItResult(a)};function LmsComScorm12(){this.allow_launch=false;this.object_type_name="LmsComScorm12"}LmsComScorm12.prototype=new LmsComBase;LmsComScorm12.prototype.constructor=LmsComScorm12;LmsComScorm12.prototype.BaseClass=LmsComBase.prototype;
LmsComScorm12.prototype.Begin=function(){LmsComScorm12.prototype.BaseClass.Begin.call(this);lmslog.addEntry(0,"LmsComScorm12.Begin","","Start");if(this.API==null){this.allow_launch=true;return false}if(this.API.LMSInitialize("")=="false"){var a=this.API.LMSGetLastError(),b=this.API.LMSGetErrorString(a)+"\n"+this.API.LMSGetDiagnostic("");this.API=null;lms_ConnectionLost(a+" "+b);lmslog.addEntry(0,"LmsComScorm12.Begin","",b);return false}this.lesson_status=this.original_lesson_status=this.doLMSGetValue("cmi.core.lesson_status");
this.lesson_data=this.doLMSGetValue("cmi.suspend_data");this.lesson_location=this.doLMSGetValue("cmi.core.lesson_location");this.student_id=this.doLMSGetValue("cmi.core.student_id");this.student_name=this.doLMSGetValue("cmi.core.student_name");this.allow_launch=true;lmslog.addEntry(0,"LmsComScorm12.Begin","","LMS session started");return true};
LmsComScorm12.prototype.End=function(){LmsComScorm12.prototype.BaseClass.End.call(this);lmslog.addEntry(0,"LmsComScorm12.End","","Start");if(!this.allow_launch)return false;this.allow_launch=false;if(this.API==null)return false;this.lesson_status==LMS_INCOMPLETE?this.doLMSSetValue("cmi.core.exit","suspend"):this.doLMSSetValue("cmi.core.exit","");this.doLMSSetValue("cmi.core.session_time",this.computeTime(this.start_date,this.end_date));this.lesson_data&&this.doLMSSetValue("cmi.suspend_data",this.lesson_data);
this.lesson_location&&this.doLMSSetValue("cmi.core.lesson_location",this.lesson_location);this.SendCompletionInfo(true);if(this.API&&this.API.LMSFinish("")=="false"){var a=this.API.LMSGetLastError(),b=this.API.LMSGetErrorString(a)+"\n"+this.API.LMSGetDiagnostic("");this.API=null;lms_ConnectionLost(a+" "+b);lmslog.addEntry(0,"LmsComScorm12.End","",b);return false}this.API=null;lmslog.addEntry(0,"LmsComScorm12.End","","LMS session terminated");return true};
LmsComScorm12.prototype.SendCompletionInfo=function(a){if(this.lesson_status===LMS_NOT_ATTEMPTED)this.original_lesson_status===LMS_NOT_ATTEMPTED?this.doLMSSetValue("cmi.core.lesson_status",LMS_INCOMPLETE):this.doLMSSetValue("cmi.core.lesson_status",this.original_lesson_status);else this.doLMSSetValue("cmi.core.lesson_status",this.getReportedLessonStatus());if(this.score!==""){this.doLMSSetValue("cmi.core.score.raw",this.score);this.doLMSSetValue("cmi.core.score.min","0");this.doLMSSetValue("cmi.core.score.max",
"100")}a||this.doLMSCommit()};LmsComScorm12.prototype.LoadAPIAdapter=function(a){this.API=null;if(GetLmsComFactory())this.API=GetLmsComFactory().scorm_api_12;a()};LmsComScorm12.prototype.IsConnected=function(){return this.API!=null};LmsComScorm12.prototype.ErrorCodes={NoError:0,GeneralException:101,ElementCannotHaveChildren:202,ElementNotAnArray:203,NotInitialized:301,NotImplemented:401,InvalidSetValue:402,ElementIsReadOnly:403,ElementIsWriteOnly:404,IncorrectDataType:405};
LmsComScorm12.prototype.doLMSGetValue=function(a){if(this.API==null)return"";var b=this.API.LMSGetValue(a),c=this.API.LMSGetLastError();if(c!=this.ErrorCodes.NoError){b=this.API.LMSGetErrorString(c);lms_ConnectionLost(c+" "+b+", "+a);lmslog.addEntry(0,"doLMSGetValue","",R_scorm_getvalfail+a+" "+b);return""}lmslog.addEntry(1,"doLMSGetValue",a,b);return b};
LmsComScorm12.prototype.doLMSSetValue=function(a,b){if(this.API==null)return"false";if(this.API.LMSSetValue(a,b)=="false"){var c=this.API.LMSGetLastError();if(c!=this.ErrorCodes.NoError&&c!=this.ErrorCodes.NotImplemented){var d=this.API.LMSGetErrorString(c);lms_ConnectionLost(c+" "+d+", "+a+", "+b);lmslog.addEntry(0,"doLMSSetValue","",R_scorm_setvalfail+a+":"+b+" "+d);return"false"}}lmslog.addEntry(1,"doLMSSetValue",a,b);return"true"};
LmsComScorm12.prototype.doLMSCommit=function(){if(this.API==null)return"false";if(this.API.LMSCommit("")=="false"){var a=this.API.LMSGetLastError(),b=this.API.LMSGetErrorString(a);lms_ConnectionLost(a+" "+b);lmslog.addEntry(0,"doLMSCommit","",b);this.API=null;return"false"}lmslog.addEntry(1,"doLMSCommit","","");return"true"};function LmsComScorm2004(){this.allow_launch=false;this.object_type_name="LmsComScorm2004";this.lesson_data_location="cmi.suspend_data"}LmsComScorm2004.prototype=new LmsComBase;
LmsComScorm2004.prototype.constructor=LmsComScorm2004;LmsComScorm2004.prototype.BaseClass=LmsComBase.prototype;
LmsComScorm2004.prototype.Begin=function(){LmsComScorm2004.prototype.BaseClass.Begin.call(this);lmslog.addEntry(0,"LmsComScorm2004.Begin","","Start");if(this.API==null){this.allow_launch=true;return false}if(this.API.Initialize("")=="false"){var a=this.API.GetLastError(),b=this.API.GetErrorString(a)+"\n"+this.API.GetDiagnostic("");this.API=null;lms_ConnectionLost(a+" "+b);lmslog.addEntry(0,"LmsComScorm2004.Begin","",b);return false}this.lesson_status=this.doGetValue("cmi.completion_status");if(this.lesson_status===
"unknown")this.lesson_status=LMS_NOT_ATTEMPTED;else if(this.lesson_status===LMS_COMPLETED){a=this.doGetValue("cmi.success_status");if(a===LMS_PASSED||a===LMS_FAILED)this.lesson_status=a}this.original_lesson_status=this.lesson_status;this.lesson_data=this.doGetValue(this.lesson_data_location);this.lesson_location=this.doGetValue("cmi.location");this.student_id=this.doGetValue("cmi.learner_id");this.student_name=this.doGetValue("cmi.learner_name");this.allow_launch=true;lmslog.addEntry(0,"LmsComScorm2004.Begin",
"","LMS session started");return true};
LmsComScorm2004.prototype.End=function(){LmsComScorm2004.prototype.BaseClass.End.call(this);lmslog.addEntry(0,"LmsComScorm2004.End","","Start");if(!this.allow_launch)return false;this.allow_launch=false;if(this.API==null)return false;this.lesson_status==LMS_INCOMPLETE?this.doSetValue("cmi.exit","suspend"):this.doSetValue("cmi.exit","normal");this.doSetValue("cmi.session_time",this.computeTime(this.start_date,this.end_date));this.lesson_data&&this.doSetValue(this.lesson_data_location,this.lesson_data);
this.lesson_location&&this.doSetValue("cmi.location",this.lesson_location);this.SendCompletionInfo(true);if(this.API&&this.API.Terminate("")=="false"){var a=this.API.GetLastError(),b=this.API.GetErrorString(a)+"\n"+this.API.GetDiagnostic("");this.API=null;lms_ConnectionLost(a+" "+b);lmslog.addEntry(0,"LmsComScorm2004.End","",b);return false}this.API=null;lmslog.addEntry(0,"LmsComScorm2004.End","","LMS session terminated");return true};
LmsComScorm2004.prototype.LoadAPIAdapter=function(a){this.API=null;if(GetLmsComFactory())this.API=GetLmsComFactory().scorm_api_2004;a()};
LmsComScorm2004.prototype.SendCompletionInfo=function(a){var b=this.getReportedLessonStatus();if(b===LMS_NOT_ATTEMPTED)b=this.original_lesson_status;if(b==LMS_PASSED||b==LMS_FAILED){this.doSetValue("cmi.success_status",b);this.doSetValue("cmi.completion_status",LMS_COMPLETED)}else this.doSetValue("cmi.completion_status",b);if(this.score!==""){this.doSetValue("cmi.score.raw",this.score);this.doSetValue("cmi.score.scaled",this.score/100);this.doSetValue("cmi.score.min","0");this.doSetValue("cmi.score.max",
"100")}a||this.doCommit()};LmsComScorm2004.prototype.convertTotalSeconds=function(a){var b=a%60;a-=b;var c=a%3600;a-=c;b=Math.round(b*100)/100;var d=b=new String(b);if(b.indexOf(".")!=-1){d=b.substring(0,b.indexOf("."));b.substring(b.indexOf(".")+1,b.length)}if(d.length<2)d="0"+d;b=d;a=a%3600!=0?0:a/3600;c=c%60!=0?0:c/60;if((new String(a)).length<2)a="0"+a;if((new String(c)).length<2)c="0"+c;return"PT"+a+"H"+c+"M"+b+"S"};LmsComScorm2004.prototype.IsConnected=function(){return this.API!=null};
LmsComScorm2004.prototype.ErrorCodes={NoError:0,GeneralException:101,GeneralInitializationFailure:102,AlreadyInitialized:103,ContentInstanceTerminated:104,GeneralTerminationFailure:111,TerminationBeforeInitialization:112,TerminationAfterTermination:113,RetrieveDataBeforeInitialization:122,RetrieveDataAfterTermination:123,StoreDataBeforeInitialization:132,StoreDataAfterTermination:133,CommitBeforeInitialization:142,CommitAfterTermination:143,GeneralArgumentError:201,GeneralGetFailure:301,GeneralSetFailure:351,
GeneralCommitFailure:391,UndefinedDataModelElement:401,UnimplementedDataModelElement:402,DataModelElementValueNotInitialized:403,DataModelElementIsReadOnly:404,DataModelElementIsWriteOnly:405,DataModelElementTypeMismatch:406,DataModelElementValueOutOfRange:407,DataModelDependencyNotEstablished:408,KPathTimeout:1501,KPathConnect:1502,KPathBusy:1503};
LmsComScorm2004.prototype.doGetValue=function(a){if(this.API==null)return"";var b=this.API.GetValue(a),c=this.API.GetLastError();if(c!=this.ErrorCodes.NoError&&c!=this.ErrorCodes.DataModelElementValueNotInitialized)if(c==this.ErrorCodes.KPathTimeout&&this.object_type_name=="LmsComKPath"){lmslog.addEntry(0,"doGetValue","","KCenter timeout");c=this.API.GetValue("upk.idle_time");lmslog.addEntry(0,"doGetValue","upk.idle_time",c);this.idle_time+=c;this.mode_idle_time+=c;lmslog.addEntry(0,"doGetValue",
"idle_time",this.idle_time);return this.doGetValue(a)}else{b=this.API.GetErrorString(c);lms_ConnectionLost(c+" "+b+", "+a);lmslog.addEntry(0,"doGetValue","",R_scorm_getvalfail+a+" "+b);return""}lmslog.addEntry(1,"doGetValue",a,b);return b};
LmsComScorm2004.prototype.doSetValue=function(a,b){if(this.API==null)return"false";if(this.API.SetValue(a,b)=="false"){var c=this.API.GetLastError();if(c!=this.ErrorCodes.NoError&&c!=this.ErrorCodes.UnimplementedDataModelElement)if(c==this.ErrorCodes.KPathTimeout&&this.object_type_name=="LmsComKPath"){lmslog.addEntry(0,"doSetValue","","KCenter timeout");c=this.API.GetValue("upk.idle_time");lmslog.addEntry(0,"doSetValue","upk.idle_time",c);this.idle_time+=c;this.mode_idle_time+=c;lmslog.addEntry(0,
"doSetValue","idle_time",this.idle_time);return this.doSetValue(a,b)}else{var d=this.API.GetErrorString(c);lms_ConnectionLost(c+" "+d+", "+a+", "+b);lmslog.addEntry(0,"doSetValue","",R_scorm_setvalfail+a+":"+b+" "+d);return"false"}}lmslog.addEntry(1,"doSetValue",a,b);return"true"};
LmsComScorm2004.prototype.doCommit=function(){if(this.API==null)return"false";if(this.API.Commit("")=="false"){var a=this.API.GetLastError(),b=this.API.GetErrorString(a);this.API=null;lms_ConnectionLost(a+" "+b);lmslog.addEntry(0,"doCommit","",b);return"false"}lmslog.addEntry(1,"doCommit","","");return"true"};
function LmsComKPath(a){this.allow_launch=false;if(a!=null){this.Copy(a);this.ParentLmsCom=a}this.object_type_name="LmsComKPath";this.lesson_data_location="upk.sco_data";this.commitNeeded=this.commitActive=false}LmsComKPath.prototype=new LmsComScorm2004;LmsComKPath.prototype.constructor=LmsComKPath;LmsComKPath.prototype.BaseClass=LmsComScorm2004.prototype;
LmsComKPath.prototype.Begin=function(){lmslog.addEntry(0,"LmsComKPath.Begin","","Start");var a=LmsComKPath.prototype.BaseClass.Begin.call(this);this.doSetValue("upk.launch_from",GetTopLevelLmsMode());lmslog.addEntry(0,"LmsComKPath.Begin","","LMS session started");return a};
LmsComKPath.prototype.SendCompletionInfo=function(a){var b=this.getReportedLessonStatus();if(b===LMS_NOT_ATTEMPTED)this.doSetValue("cmi.completion_status",LMS_NOT_ATTEMPTED);else{if(b==LMS_PASSED||b==LMS_FAILED){this.doSetValue("cmi.success_status",b);this.doSetValue("cmi.completion_status",LMS_COMPLETED)}else this.doSetValue("cmi.completion_status",b);if(this.score!==""){this.doSetValue("cmi.score.raw",this.score);this.doSetValue("cmi.score.scaled",this.score/100);this.doSetValue("cmi.score.min",
"0");this.doSetValue("cmi.score.max","100")}a||this.doCommit()}};LmsComKPath.prototype.LoadAPIAdapter=function(a){if(this.API)a();else{var b=findKPathAPIFrame(window);if(b&&b.LoadRuntime&&this.guid){this.deferred_callback=a;var c=this;b.LoadRuntime(this.guid,0,0,0,function(d,e,f,h){c.LoadAPIAdapterCallback(d,e,f,h)},upk.browserInfo.isTouchDevice(),this.isTestIt)}else a()}};
LmsComKPath.prototype.LoadAPIAdapterCallback=function(a,b,c,d){if(a=="succeeded"&&b==this.guid){this.API=c.GetAPI();lmslog.addEntry(0,"LoadAPIAdapterCallback","","KPath adapter bound");try{this.deferred_callback()}catch(e){}}else{if(a=="no SCO")this.API=null;else alert(R_scorm_noapi+" "+d);lmslog.addEntry(0,"LoadAPIAdapterCallback","",d);this.deferred_callback()}};LmsComKPath.prototype.doGetUPKValue=function(a){a=this.doGetValue(a);if(a==="")a=-1;return a};
LmsComKPath.prototype.doSetUPKValue=function(a,b){this.doSetValue(a,b)};LmsComKPath.prototype.doUPKCommit=function(){this.doCommit()};
LmsComKPath.prototype.doCommit=function(){if(this.API==null)return"false";if(this.commitActive){lmslog.addEntry(0,"doCommit","commitActive==true","");this.commitNeeded=true;return"true"}lmslog.addEntry(1,"doCommit","","");if(upk.browserInfo.isTouchDevice())b=null;else{this.commitActive=true;var a=this,b=function(d,e){a.doCommitCallback(d,e)}}if(this.API.Commit("",b)=="false"){this.commitActive=false;b=this.API.GetLastError();var c=this.API.GetErrorString(b);if(b==this.ErrorCodes.KPathTimeout&&this.object_type_name==
"LmsComKPath"){lmslog.addEntry(0,"doCommit","","KCenter timeout");b=this.API.GetValue("upk.idle_time");lmslog.addEntry(0,"doCommit","upk.idle_time",b);this.idle_time+=b;this.mode_idle_time+=b;lmslog.addEntry(0,"doCommit","idle_time",this.idle_time);return this.doCommit()}else{this.API=null;lms_ConnectionLost(b+" "+c);lmslog.addEntry(0,"doCommit","",c);return"false"}}return"true"};
LmsComKPath.prototype.doCommitCallback=function(a,b){lmslog.addEntry(1,"doCommitCallback","","");this.commitActive=false;if(!a){this.API=null;lms_ConnectionLost(b);lmslog.addEntry(0,"doCommitCallback","",b)}if(this.commitNeeded){this.commitNeeded=false;this.doCommit()}};
LmsComKPath.prototype.setInteraction=function(a,b){if(this.API){var c=b.status_obj,d=this.doGetValue("cmi.interactions._count");if(a==-1)a=d;a>=d&&this.doSetValue("cmi.interactions."+a+".id",b.guid);this.doSetValue("cmi.interactions."+a+".type",c.getQuestionType());this.doSetValue("cmi.interactions."+a+".timestamp",(new Date).toSCORM());this.doSetValue("cmi.interactions."+a+".weighting","1");if(c.getResult()){this.doSetValue("cmi.interactions."+a+".learner_response",c.getLearnerResponse());this.doSetValue("cmi.interactions."+
a+".result",c.getResult())}this.doCommit();return a}};LmsComKPath.prototype.getAnsweredQuestions=function(){var a={};if(!this.API)return a;for(var b=this.doGetValue("cmi.interactions._count"),c=0;c<b;c++){var d=this.doGetValue("cmi.interactions."+c+".id");a[d]={index:c};a[d].weighting=this.doGetValue("cmi.interactions."+c+".weighting");a[d].result=this.doGetValue("cmi.interactions."+c+".result")}return a};
LmsComKPath.prototype.setObjective=function(a,b){if(this.API){this.doSetValue("cmi.objectives."+a+".id",b.objectiveGuid=="PRIMARYOBJ"?"PRIMARYOBJ":"OBJ_"+b.objectiveGuid);this.doSetValue("cmi.objectives."+a+".score.scaled",b.score/100);this.doSetValue("cmi.objectives."+a+".completion_status",b.completed?"completed":"incomplete");this.doSetValue("cmi.objectives."+a+".success_status",b.completed?"passed":"failed")}};
LmsComKPath.prototype.requestContinue=function(){this.doSetValue("adl.nav.request","continue")};LmsComKPath.prototype.utGetModeIndex=function(){this.mode_index=this.doGetValue("upk.modes._count")};LmsComKPath.prototype.utPushModeIndex=function(){this.saved_mode_index=this.mode_index;this.utGetModeIndex()};LmsComKPath.prototype.utPopModeIndex=function(){this.mode_index=this.saved_mode_index;delete this.saved_mode_index};
LmsComKPath.prototype.utRecordType=function(a){this.doSetValue("upk.modes."+this.mode_index+".type",a)};LmsComKPath.prototype.utRecordStartTime=function(a){this.doSetValue("upk.modes."+this.mode_index+".start_time",a.toSCORM());this.mode_idle_time=0};LmsComKPath.prototype.utRecordEndTime=function(a){this.doSetValue("upk.modes."+this.mode_index+".end_time",a.toSCORM())};
LmsComKPath.prototype.utRecordTimespan=function(a){this.doSetValue("upk.modes."+this.mode_index+".timespan",a-this.mode_idle_time/1E3)};LmsComKPath.prototype.utRecordCompletionStatus=function(a){this.doSetValue("upk.modes."+this.mode_index+".completion_status",a)};LmsComKPath.prototype.utRecordSuccessStatus=function(a){this.doSetValue("upk.modes."+this.mode_index+".success_status",a)};
LmsComKPath.prototype.utRecordScoreScaled=function(a){this.doSetValue("upk.modes."+this.mode_index+".score.scaled",a)};LmsComKPath.prototype.utRecordFrameViewed=function(a){this.doSetValue("upk.modes."+this.mode_index+".frame_viewed",a);this.doSetValue("cmi.session_time",this.computeTime(this.start_date,(new Date).getTime()));this.doCommit()};LmsComKPath.prototype.utSendTestItResult=function(a){this.doSetValue("upk.modes."+this.mode_index+".test_result",a);this.doCommit()};
function LmsComAICC(a,b){this.allow_launch=false;this.aicc_url=a;this.aicc_sid=b;this.app=document.applets.GetHTTPPostData;this.object_type_name="LmsComAICC"}LmsComAICC.prototype=new LmsComBase;LmsComAICC.prototype.constructor=LmsComScorm12;LmsComAICC.prototype.BaseClass=LmsComBase.prototype;LmsComAICC.prototype.Begin=function(){LmsComAICC.prototype.BaseClass.Begin.call(this);lmslog.addEntry(0,"LmsComAICC.Begin","","Start");this.hacpGetparam();lmslog.addEntry(0,"LmsComAICC.Begin","","about to log paramvalues")};
LmsComAICC.prototype.End=function(){LmsComAICC.prototype.BaseClass.End.call(this);lmslog.addEntry(0,"LmsComAICC.End","","Start");if(!this.allow_launch)return false;this.allow_launch=false;var a=this.hacpGetpostdata();a="command=putparam&version="+LmsConfig.AiccVersion+"&session_id="+this.aicc_sid+"&aicc_data="+escape(a)+"&";lmslog.addEntry(0,"LmsComAICC.End","params",a);a=this.app.GetData(unescape(this.aicc_url),a);lmslog.addEntry(0,"LmsComAICC.End","strData",a);a="version="+LmsConfig.AiccVersion+
"&command=ExitAU&session_id="+this.aicc_sid+"&";lmslog.addEntry(0,"LmsComAICC.End","params",a);a=this.app.GetData(unescape(this.aicc_url),a);lmslog.addEntry(0,"LmsComAICC.End","strData",a)};var closingAmp=true;
LmsComAICC.prototype.hacpGetparam=function(){lmslog.addEntry(0,"hacpGetparam","","Start");var a="";a="version="+LmsConfig.AiccVersion+"&command=GetParam&session_id="+this.aicc_sid;if(closingAmp)a+="&";lmslog.addEntry(0,"hacpGetparam","params",a);a=this.app.GetData(unescape(this.aicc_url),a);lmslog.addEntry(0,"hacpGetparam","strData",a);var b,c,d=false;a+=" ";for(var e=a.split("\r"),f=0;f<e.length;f++){var h=e[f],g=trimValue(h.substring(0,h.indexOf("="))),i=trimValue(h.substring(h.indexOf("=")+1));
if(g.toLowerCase()=="error"){b=i;d=true}if(g.toLowerCase()=="error_text")c=i;if(g.toLowerCase()=="aicc_data"){this.aicc_data=a.substring(a.indexOf(h.substring(0,h.indexOf("=")))+h.substring(0,h.indexOf("=")).length+1);d=true}}if(d)if(b==0){e=get_group_content("core",this.aicc_data).split("\r");for(f=0;f<e.length;f++){h=e[f];g=trimValue(h.substring(0,h.indexOf("=")));i=trimValue(h.substring(h.indexOf("=")+1));if(g.toLowerCase()=="student_id")this.student_id=i;if(g.toLowerCase()=="student_name")this.student_name=
i;if(g.toLowerCase()=="lesson_status"){this.lesson_status=i.toLowerCase().charAt(0);if(i.indexOf(",")!=-1)this.lesson_flag=trimValue(i.substring(i.indexOf(",")+1)).toLowerCase();if(this.lesson_status=="p")this.lesson_status=LMS_PASSED;if(this.lesson_status=="c")this.lesson_status=LMS_COMPLETED;if(this.lesson_status=="f")this.lesson_status=LMS_FAILED;if(this.lesson_status=="i")this.lesson_status=LMS_INCOMPLETE;if(this.lesson_status=="n")this.lesson_status=LMS_NOT_ATTEMPTED;this.original_lesson_status=
this.lesson_status}if(g.toLowerCase()=="lesson_location")this.lesson_location=i;if(g.toLowerCase()=="credit")this.credit=i;if(g.toLowerCase()=="score")this.score=i;if(g.toLowerCase()=="time")this.time=i}this.lesson_data=this.lesson_status==LMS_INCOMPLETE||this.lesson_status==LMS_COMPLETED||this.lesson_status==LMS_PASSED||this.lesson_status==LMS_FAILED?trimValue(get_group_content("core_lesson",this.aicc_data)):"";this.core_vendor=trimValue(get_group_content("core_vendor",this.aicc_data));this.allow_launch=
true}else{alert(R_error_unexp+c);lmslog.addEntry(0,"hacpGetparam","","Unable to continue because of the following error: "+c)}else{alert(R_error_svr+unescape(this.aicc_url)+"\r\r - "+a);lmslog.addEntry(0,"hacpGetparam","","Unable to post to server "+unescape(this.aicc_url)+" - "+a)}};
LmsComAICC.prototype.hacpGetpostdata=function(){lmslog.addEntry(0,"hacpGetpostdata","","Start");var a="";a="[CORE]\r\n";a+="Lesson_Location=\r\n";var b=this.getReportedLessonStatus();if(b===LMS_NOT_ATTEMPTED)b=this.original_lesson_status;a+=this.lesson_status===LMS_INCOMPLETE?"Lesson_Status="+b+", suspend\r\n":"Lesson_Status="+b+"\r\n";lmslog.addEntry(0,"hacpGetpostdata","is_assess",this.is_assess);a+=this.score!==""?"Score="+this.score+"\r\n":"Score=\r\n";a+="Time="+this.computeTime(this.start_date,
this.end_date)+"\r\n";a+="[CORE_LESSON]\r\n";a+=this.lesson_data+"\r\n";lmslog.addEntry(0,"hacpGetpostdata","NewAiccData",a);return a};function get_group_content(a,b){for(var c="",d=b.split("\r"),e=false,f=0;f<d.length;f++){var h=trimValue(d[f]);if(h.substr(0,1)=="[")e=h.toLowerCase().indexOf("["+a.toLowerCase()+"]")>=0?true:false;else if(e)c+=h+"\r\n"}return c}
function trimValue(a){for(var b=0,c=a.length,d=0;d<a.length;d++)if(a.substr(d,1)!=" "&&a.substr(d,1)!="\t"&&a.substr(d,1)!="\n"&&a.substr(d,1)!="\r"){b=d;break}if(d==a.length)return"";for(d=a.length-1;d>0;d--)if(a.substr(d,1)!=" "&&a.substr(d,1)!="\t"&&a.substr(d,1)!="\n"&&a.substr(d,1)!="\r"){c=d;break}if(d==0)c=0;return a.substring(b,c+1)}LmsComAICC.prototype.IsConnected=function(){return true};function LmsComCookie(){this.allow_launch=false;this.object_type_name="LmsComCookie"}
LmsComCookie.prototype=new LmsComBase;LmsComCookie.prototype.constructor=LmsComCookie;LmsComCookie.prototype.BaseClass=LmsComBase.prototype;LmsComCookie.prototype.Begin=function(){LmsComCookie.prototype.BaseClass.Begin.call(this)};LmsComCookie.prototype.End=function(){LmsComCookie.prototype.BaseClass.End.call(this)};function LmsBasicStatus(){this.status=LMS_NOT_ATTEMPTED}LmsBasicStatus.prototype.getStatus=function(){return this.status};LmsBasicStatus.prototype.setStatus=function(a){this.status=a};
LmsBasicStatus.prototype.Save=function(a){a.lesson_status=this.status};LmsTopicStatus.prototype=new LmsBasicStatus;LmsTopicStatus.prototype.constructor=LmsTopicStatus;LmsTopicStatus.prototype.BaseClass=LmsBasicStatus.prototype;function LmsTopicStatus(){this.score="";this.passed=false;this.modes=[];this.modes.S=new Mode("S");this.modes.T=new Mode("T");this.modes.K=new Mode("K");this.modes.D=new Mode("D");this.modes.P=new Mode("P");this.modes.E=new Mode("E");this.anylaunched=false}
LmsTopicStatus.prototype.Save=function(a){a.lesson_data=a.bigsco?"":this.getStatusstring();a.lesson_status=this.getLMSStatus();a.score=this.getScore()};LmsTopicStatus.prototype.setModeavail=function(a,b){this.modes[a].avail=b};LmsTopicStatus.prototype.getModeavail=function(a){return this.modes[a].avail};LmsTopicStatus.prototype.setModestatus=function(a,b){if(this.modes[a].avail)this.modes[a].complete=b;else lmslog.addEntry(0,"setModestatus","","Invalid call of setModestatus")};
LmsTopicStatus.prototype.getModestatus=function(a){return this.modes[a].complete};LmsTopicStatus.prototype.setRequiredMode=function(a,b,c){this.requiredMode=GetTopLevelLmsMode()=="LMS"?c||this._getRequiredMode(a):this._getRequiredMode(b)};LmsTopicStatus.prototype._getRequiredMode=function(a){for(var b=0;b<6;b++)if(a["EKTSPD".charAt(b)])return"EKTSPD".charAt(b);return"None"};LmsTopicStatus.prototype.GetRequiredMode=function(){return this.requiredMode};
LmsTopicStatus.prototype.initTopicstat=function(a){lmslog.addEntry(0,"initTopicstat","","Start");lmslog.addEntry(0,"initTopicstat","s string",a);lmslog.addEntry(0,"initTopicstat","s.length",a.length);if(a.length!=0){var b=a.split(",");for(a=0;a<=b.length-1;a++){lmslog.addEntry(0,"initTopicstat","f["+a+"]",b[a]);if(b[a].charAt(1)=="=")this.modes[b[a].charAt(0)].complete=this.modeIscomplete(b[a].substr(2,1));else if(b[a].substr(0,5)=="PASS=")this.passed=b[a].substr(5,1)!=="0";else if(b[a].substr(0,
6)=="SCORE=")this.score=b[a].substr(6)}}};LmsTopicStatus.prototype.clearTopicstat=function(){this.score="";this.passed=false;for(var a in this.modes)this.modes[a].complete=false};
LmsTopicStatus.prototype.getStatusstring=function(){lmslog.addEntry(0,"get_statusstring","","Start");var a="";for(x in this.modes){if(a.length!=0)a+=",";a+=this.modes[x].id+"="+(this.modes[x].complete?"C":"I")}if(this.modes.E.complete)a+=",PASS="+(this.passed?"1":"0");else if(this.requiredMode==="K"&&this.modes.K.complete&&this.isScored)a+=",PASS="+(this.passed?"1":"0")+",SCORE="+this.score;lmslog.addEntry(0,"get_statusstring","dataString",a);return a};
LmsTopicStatus.prototype.getStatus=function(){var a="";if(this.isComplete())if(this.requiredMode==="K"&&this.isScored||this.requiredMode==="E")a=this.passed?LMS_PASSED:LMS_FAILED;else{a=LMS_COMPLETED;if(this.savedStatus=="P"||this.savedStatus=="F")a=this.savedStatus}else{a=LMS_INCOMPLETE;if(this.savedStatus=="P"||this.savedStatus=="F"||this.savedStatus=="C")a=Stat2Lms(this.savedStatus)}return a};
LmsTopicStatus.prototype.getLMSStatus=function(){if(this.isComplete()&&!this.anylaunched)return LMS_NOT_ATTEMPTED;return this.getStatus()};LmsTopicStatus.prototype.getScore=function(){return this.score};LmsTopicStatus.prototype.isComplete=function(){lmslog.addEntry(0,"is_complete","","Start");var a=false;if(this.requiredMode==="None"||this.modes[this.requiredMode].complete)a=true;lmslog.addEntry(0,"is_complete","iscomp",a);return a};
LmsTopicStatus.prototype.modeIscomplete=function(a){var b=false;lmslog.addEntry(0,"modeIscomplete","","Start");if(a=="C")b=true;else if(a=="I")b=false;lmslog.addEntry(0,"modeIscomplete","ret",b);return b};LmsTopicStatus.prototype.isRequired=function(a){return this.requiredMode===a};LmsTopicLaunchStatus.prototype=new LmsTopicStatus;LmsTopicLaunchStatus.prototype.constructor=LmsTopicStatus;LmsTopicLaunchStatus.prototype.BaseClass=LmsTopicStatus.prototype;
function LmsTopicLaunchStatus(a){this.mode=this.modes[a];this.score="";this.passed=false;this.anylaunched=true}LmsTopicLaunchStatus.prototype.Save=function(a){this.BaseClass.Save.call(this,a)};LmsTopicLaunchStatus.prototype._getRequiredMode=function(a){for(var b=0;b<6;b++)if(a.indexOf("EKTSPD".charAt(b))!=-1)return"EKTSPD".charAt(b);return"None"};LmsTopicLaunchStatus.prototype.getResult=function(){return this.passed?"correct":"incorrect"};LmsTopicLaunchStatus.prototype.getQuestionType=function(){return"other"};
LmsTopicLaunchStatus.prototype.getLearnerResponse=function(){return""};function Mode(a){this.complete=this.avail=false;this.id=a}LmsQuestionStatus.prototype=new LmsBasicStatus;LmsQuestionStatus.prototype.constructor=LmsQuestionStatus;LmsQuestionStatus.prototype.BaseClass=LmsBasicStatus.prototype;function LmsQuestionStatus(){this.result=this.learner_response=this.question_type=null}LmsQuestionStatus.prototype.Save=function(a){a.lesson_status=this.status;a.lesson_data=Lms2Stat(this.getStatus())};
LmsQuestionStatus.prototype.getStatus=function(){return this.status===LMS_NOT_ATTEMPTED?this.savedStatus:this.status};LmsQuestionStatus.prototype.getQuestionType=function(){return this.question_type};LmsQuestionStatus.prototype.setQuestionType=function(a){return this.question_type=a};LmsQuestionStatus.prototype.getLearnerResponse=function(){return this.learner_response};LmsQuestionStatus.prototype.setLearnerResponse=function(a){return this.learner_response=a};
LmsQuestionStatus.prototype.getResult=function(){return this.result};LmsQuestionStatus.prototype.setResult=function(a){return this.result=a};LmsAssessmentStatus.prototype=new LmsBasicStatus;LmsAssessmentStatus.prototype.constructor=LmsAssessmentStatus;LmsAssessmentStatus.prototype.BaseClass=LmsBasicStatus.prototype;function LmsAssessmentStatus(){this.score="";this.questionstatus=[];this.stateDiscarded=false}
LmsAssessmentStatus.prototype.Save=function(a){a.lesson_status=this.status;a.score=this.status!=LMS_INCOMPLETE&&this.status!=LMS_NOT_ATTEMPTED?this.score:"";var b="";if(!a.bigsco){b=this.hash.length+"@"+this.hash;var c=this.questionlimit.toString();b+=c.length+"@"+c}b+=this.status==LMS_NOT_ATTEMPTED?this.savedStatus:Lms2Stat(this.status);for(c=0;c<this.questionstatus.length;c++)b+=this.questionstatus[c];a.lesson_data=b};
LmsAssessmentStatus.prototype.getStatus=function(){return this.status===LMS_NOT_ATTEMPTED?Stat2Lms(this.savedStatus):this.status};LmsAssessmentStatus.prototype.getLMSStatus=function(){return this.status};LmsAssessmentStatus.prototype.getScore=function(){return this.score};LmsAssessmentStatus.prototype.setScore=function(a){return this.score=a};LmsTOCStatus.prototype=new LmsBasicStatus;LmsTOCStatus.prototype.constructor=LmsTOCStatus;LmsTOCStatus.prototype.BaseClass=LmsBasicStatus.prototype;
function LmsTOCStatus(){}LmsTOCStatus.prototype.getStatus=function(){return Stat2Lms(this.getTocState().GetStatus(0))};LmsTOCStatus.prototype.Save=function(a){a.lesson_status=this.getStatus();var b=this.getTocState();a.lesson_data=b.SerializeTOC()};LmsTOCStatus.prototype.getTocState=function(){return this.tocstate};LmsTOCStatus.prototype.setTocState=function(a){return this.tocstate=a};function NodeState(){this.Status="N";this.Score=null;this.ChildrenStatus=""}
function TOCState(a,b){this.NodeCounter=a;this.TocVersion=b;this.InitInLookupTable()}TOCState.prototype.SetStatus=function(a,b){this.LookUpTable[a]||(this.LookUpTable[a]=new NodeState);this.LookUpTable[a].Status=b};TOCState.prototype.GetStatus=function(a){return this.LookUpTable[a].Status};TOCState.prototype.SetScore=function(a,b){this.LookUpTable[a]||(this.LookUpTable[a]=new NodeState);this.LookUpTable[a].Score=b};TOCState.prototype.GetScore=function(a){return this.LookUpTable[a].Score};
TOCState.prototype.SetChildren=function(a,b){this.LookUpTable[a]||(this.LookUpTable[a]=new NodeState);this.LookUpTable[a].ChildrenStatus=b};TOCState.prototype.GetChildren=function(a){return this.LookUpTable[a].ChildrenStatus};
TOCState.prototype.DeserializeTOC=function(a){var b=0,c,d=a.indexOf("@");if(d>0){b=parseInt(a.substring(0,d));c=a.substring(d+1,d+b+1);if(c==this.TocVersion){a=a.substring(d+b+2);d=a.indexOf("@");if(d>0){b=parseInt(a.substring(0,d));a=a.substring(d+1,d+b+1);if(a.length==b){a=this.RLESDecode(a);this.DeserializeLookUpTable(a)}}}}};
TOCState.prototype.DeserializeLookUpTable=function(a){for(var b=0,c="",d=0;d<a.length;d++){c=a.charAt(d);this.SetStatus(b,c);for(c="";d<a.length-1&&a.charAt(d+1)>="0"&&a.charAt(d+1)<="9";){d++;c+=a.charAt(d)}c.length>0&&this.SetScore(b,parseInt(c));if(d<a.length-1&&a.charAt(d+1)=="{"){c=a.indexOf("}",d+2);this.SetChildren(b,a.substring(d+2,c));d=c}b++}};
TOCState.prototype.SerializeTOC=function(){var a=this.RLESEncode(this.SerializeLookupTable());return this.TocVersion.length+"@"+this.TocVersion+" "+a.length+"@"+a};TOCState.prototype.SerializeLookupTable=function(){for(var a="",b=0;b<this.NodeCounter;b++){var c=this.LookUpTable[b].Status,d=this.LookUpTable[b].ChildrenStatus;c||(c="N");a+=c;if(d)a+="{"+d+"}"}return a};
TOCState.prototype.InitInLookupTable=function(){this.LookUpTable=[];for(var a=0;a<this.NodeCounter;a++)this.LookUpTable[a]=new NodeState;this.SetStatus(0,"I")};TOCState.prototype.RLESEncode=function(a){var b="",c=0,d="";b=a.charAt(0);for(var e=c=1;e<a.length;e++)if(a.charAt(e)==b)c++;else{if(c>2){d+="#";d+=c;d+=b}else d+=a.substring(e-c,e);b=a.charAt(e);c=1}if(c>2){d+="#";d+=c;d+=b}else d+=a.substring(e-c,e);return d};
TOCState.prototype.RLESDecode=function(a){for(var b="",c="",d=0;d<a.length;d++)if(a.charAt(d)=="#"){c="";for(d++;a.charAt(d)>="0"&&a.charAt(d)<="9";){c+=a.charAt(d);d++}c=parseInt(c);for(var e=0;e<c;e++)b+=a.charAt(d)}else b+=a.charAt(d);return b};function Lms2Stat(a){return a.charAt(0).toUpperCase()}function Stat2Lms(a){return[LMS_PASSED,LMS_FAILED,LMS_COMPLETED,LMS_INCOMPLETE,LMS_NOT_ATTEMPTED]["PFCIN".indexOf(a)]}
function LogEntry(a,b,c,d,e){this.logType=b;this.funcName=c;this.varName=d;this.msgValue=e;this.dateTime=(new Date).getTime()-a}LogEntry.prototype.GetTableRow=function(){var a="#006600";if(this.logType===1)a="#000033";var b=this.varName;if(b==="")b="&nbsp;";var c=this.msgValue;if(c==="")c="&nbsp;";var d="<tr>";d+="<td align='right'>"+this.dateTime/1E3+"</td>";d+="<td style='color:"+a+";'>"+this.funcName+"</td>";d+="<td>"+b+"</td>";d+="<td>"+c+"</td>";d+="</tr>";return d};
function Log(a){this.traceWindow=null;this.logArray=[];this.enabled=a;this.startDateTime=new Date;this.changed=true;this.windowReady=false;this.startLog()}Log.prototype.startLog=function(){if(this.enabled){this.addEntry(0,"initLog","","Log Intialized");this.openTraceWindow()}};Log.prototype.addEntry=function(a,b,c,d){if(this.enabled){this.logArray.push(new LogEntry(this.startDateTime.getTime(),a,b,c,d));this.changed=true;this.traceWindow&&this.windowReady&&this.traceWindow.UpdateTraceStack()}};
Log.prototype.writeLog=function(a,b){var c=b;if(c>this.logArray.length||c==0)c=this.logArray.length;var d="<table width='600'>";d+="<tr>";d+="<th colspan=4>Session start: "+this.startDateTime+"</th>";d+="</tr>";d+="<tr>";d+="<th>time</th>";d+="<th>function</th>";d+="<th>variable</th>";d+="<th>message</th>";d+="</tr>";var e;if(a==0)for(var f=this.logArray.length-c;f<this.logArray.length;f++){e=this.logArray[f];d+=e.GetTableRow(f)}else for(f=this.logArray.length-1;f>=this.logArray.length-c;f--){e=this.logArray[f];
d+=e.GetTableRow(f)}d+="</table>";this.changed=false;this.windowReady=true;return d};Log.prototype.writeDetails=function(a){return this.logArray[a].GetDetails()};Log.prototype.openTraceWindow=function(){if(this.traceWindow==null){this.changed=true;this.traceWindow=window.open(lms_path+"html/lmsdebug.html","_blank")}};
var Escape=function(){function a(e,f){for(var h="",g=0;g<e.length;g++){var i=e.substr(g,1),k;if(f==0)k=i>="0"&&i<="9"||i>="a"&&i<="z"||i>="A"&&i<="Z";else{a:{k=d.length;for(var m=0;m<k;m++)if(i==d[m]){k=true;break a}k=i==c?true:false}k=!k}if(k)h+=i;else{i=e.charCodeAt(g);i="0000"+i.toString(16).toUpperCase();h+=(f==0?"$":c)+i.substr(i.length-4)}}return h}function b(e,f){for(var h="",g=false,i=0;i<e.length;i++){var k;if(g){k=e.substr(i,4);h+=String.fromCharCode(parseInt("0x"+k));i+=3;g=false}else{k=
e.substr(i,1);if(k==(f==0?"$":c))g=true;else h+=k}}return h}var c="/",d=["<",">",'"',"'","%",";","(",")","&","+"];return{SafeUriEscape:function(e){return a(e,1)},SafeUriUnEscape:function(e){return b(e,1)},MyEscape:function(e){return a(e,0)},MyUnEscape:function(e){return b(e,0)}}}();function UrlParser(){this.params=[];this.safemode=false}
UrlParser.prototype.Clone=function(){var a=new UrlParser;a.params=[];a.safemode=this.safemode;for(var b in this.params)if(this.params[b]!=null)a.params[b]=this.params[b];return a};
UrlParser.prototype.Parse=function(){var a,b;a=document.location.hash.substring(1);a=a.split("&");if(a.length==0||a[0]==""){a=document.location.search.substring(1);a=a.split("&")}if(a.length>0)if(a[0].toLowerCase().substr(0,3)=="su="){this.safemode=true;a=a[0].substr(3);a=Escape.SafeUriUnEscape(a);a=a.split("&")}for(var c=0;c<a.length;c++){b=a[c];if(b.length!=0){var d=b.split("=");if(d.length==2)this.params[d[0].toLowerCase()]=d[1];else if(d.length<2)this.params[d[0].toLowerCase()]="";else this.params[d[0].toLowerCase()]=
b.substr(d[0].length+1)}}};UrlParser.prototype.GetSafeMode=function(){return this.safemode};UrlParser.prototype.SetSafeMode=function(a){this.safemode=a};UrlParser.prototype.GetParameter=function(a){return this.params[a.toLowerCase()]};UrlParser.prototype.AddParameter=function(a,b){this.params[a.toLowerCase()]=b};UrlParser.prototype.RemoveParameter=function(a){this.params[a.toLowerCase()]=null};UrlParser.prototype.ClearParameterList=function(){this.params=null;this.params=[]};
UrlParser.prototype.BuildParameterList=function(a){a="";var b=true,c;for(c in this.params){var d=this.params[c];if(d!=null){if(b==false)a+="&";b=false;a+=d.length==0?c:c+"="+this.params[c]}}if(this.safemode)a="su="+Escape.MyEscape(a);return a};
UrlParser.prototype.GetCorrectUrl=function(a,b){if(!this.safemode)return a;var c,d=a.indexOf("#");if(d==-1)d=a.indexOf("?");if(d>=0){var e=a.substring(d+1);c=e.split("&");if(c[0].toLowerCase().substr(0,3)=="su=")return a;return a.substring(0,d+1)+"su="+Escape.SafeUriEscape(e)}else return a+(b?"":"?su=")};function UnescapeQuotes(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}var _lmsMode=null,_lmsParser=null;
function InitLmsMode(a){if(_lmsParser==null){_lmsParser=new UrlParser;_lmsParser.Parse();if(IsTouchDevice()&&a=="player")if(parent==null||window.location==parent.location)if(_lmsParser.GetParameter("directlaunch")==null)_lmsParser.params.directlaunch=2;if(a=="player"){if(_lmsParser.GetParameter("directlaunch")!=null)_lmsMode=Kpath_launch==true?"KPT":"Cookie"}else if(a=="lmstart"){if(_lmsParser.GetParameter("toc")==null)_lmsMode=_lmsParser.GetParameter("dhtml")!=null?Kpath_launch==true?"KPT":"Cookie":
"LMS"}else if(a=="toc"){if(_lmsParser.GetParameter("sco")==null)_lmsMode=Kpath_launch==true?"KPT":"Cookie"}else alert(R_undefined_lms_source)}}function GetTopLevelLmsMode(){return _GetTopLevelLmsMode(this)}function _GetTopLevelLmsMode(a){var b=a._lmsMode;if(b==null)return _GetTopLevelLmsMode(a.lms_store.parentW);return b}var lms_initialized=false,lms_store,lmslog;
function lms_InitPage(a,b,c,d){if(lms_initialized==true)setTimeout(d,1);else{__Ialert("lms_InitPage called with parameters:"+a+","+b+","+c+","+d);var e=false;if(window.lmsModes)e=typeof window.lmsModes=="string"?window.lmsModes.indexOf("E")>-1:window.lmsModes.E===true;lms_store={window:window,childIndex:a,parentW:b,cguid:c,isTestIt:e,callbackfunction:d};if(!b||b.closed){lmslog=new Log(LmsConfig.DebugMode);InitializeLmsCom();InsertRuntimeAPI(lms_LoadRuntimeComplete)}else if(b.lms_initialized){lmslog=
b.lmslog;setTimeout(lms_LoadRuntimeComplete,1)}}}
function lms_LoadRuntimeComplete(){__Ialert("lms_LoadRuntimeComplete() called");if(lms_store.parentW&&!lms_store.parentW.closed)lms_store.parentW.GetChildLmsCom(lms_store);else if(!lms_store.parentW&&!lms_store.cguid&&!window.bigScoItemCount)document.LmsCom=PlayerConfig.EnableCookies?new LmsComCookie:new LmsComBase;else{CheckForLMSAPI();document.LmsCom=_GlobalLmsComFactory.CreateLmsCom()}var a=document.LmsCom;a.guid=lms_store.cguid;a.isTestIt=lms_store.isTestIt;a.owner=window;a.LoadAPIAdapter(lms_LoadAdapterComplete)}
function lms_UpdateUI(a){try{parent&&parent.updateUI&&parent.updateUI(a)}catch(b){}}var hasClosed=false;
function lms_ClosePage(a){__Ialert("lms_ClosePage() called");if(hasClosed!=true){hasClosed=true;var b=document.LmsCom;if(b&&b.session_active){var c=b.child;c&&c.session_active&&c.owner&&!c.owner.closed&&c.owner.lms_ClosePage(true);(c=b.ancillaryChild)&&c.session_active&&c.owner&&!c.owner.closed&&c.owner.lms_ClosePage(true);window._closePage&&_closePage();if(b.session_active){b.SaveStatus();b.End();b.NotifyParent()}a&&window.close()}}}
function lms_ConnectionLost(a){window.ConnectionLostEvent&&ConnectionLostEvent(a);lms_store.parentW&&!lms_store.parentW.closed&&lms_store.parentW.lms_ConnectionLost(a)}function lms_IsConnected(){var a=document.LmsCom;if(a)return a.IsConnected();return false}function lms_IsKPathLogoutAvailable(){return!!window.Kpath_logout_available}
function _logout(a){if(lms_store.parentW&&!lms_store.parentW.closed&&lms_store.parentW._logout)lms_store.parentW._logout(false);else if(window.Kpath_logout_URL)if(GetTopLevelLmsMode()=="LMS")window.parent.parent.location.replace(Kpath_logout_URL);else if(a)if(window.opener&&!window.opener.closed){window.opener.location.replace(Kpath_logout_URL);window.close()}else window.location.replace(Kpath_logout_URL);else window.location.replace(Kpath_logout_URL)}
function lms_IsUserProfileAvailable(){__alert("lms_IsUserProfileAvailable() called");if(GetTopLevelLmsMode()!=="KPT")return false;return document.LmsCom.doGetUPKValue("upk.anonymous")=="0"}function lms_GetUserProfileUrl(){__alert("lms_GetUserProfileUrl() called");if(Kpath_launch==false)return"";return Kpath_profile_URL+"?UPKLaunch=true"}function GetNoSound(){return lms_store.parentW&&!lms_store.parentW.closed?lms_store.parentW.GetNoSound():lms_store.noSound}
function SetNoSound(a){lms_store.noSound=a}var _lms_show_all_alert=false;function __alert(a){if(_lms_show_alert||_lms_show_all_alert)alert(a+"\nfile: "+_lms_module_name)}function __Ialert(a){if(_lms_show_alert||_lms_show_Ialert||_lms_show_all_alert)alert(a+"\nfile: "+_lms_module_name)}var upk=upk||{};
$.extend(true,upk,{contextHelper:function(){var a=null,b,c;this.SetContext=function(e,f){if(a)a.SetContext(e,f);else{c=b;b={view:e,subview:f};ias.SetContext(b)}};this.SetNamespace=function(e){a||ias.SetNamespace(e)};this.AddDiscoveryCddUrl=function(e){a||ias.AddDiscoveryCddUrl(e)};this.SetPrevContext=function(){if(a)a.SetPrevContext();else{b=c;ias.SetContext(b)}};try{if(self!=top&&typeof parent.ctxHelper==="object")a=parent.ctxHelper}catch(d){}return this}});window.ctxHelper=new upk.contextHelper;
window.ias=function(a){function b(j){var l={};if(j!=g)for(var r in j){var q=j[r];if(q!=g)l[r]=q}return l}function c(j){m=b(j);o.push(m);k=g}function d(j,l){if(l!=g)t[j]=l;else delete t[j];s=g}function e(j,l){return encodeURIComponent(j)+"="+encodeURIComponent(l)}function f(j,l){return encodeURIComponent(j)+(l==""?"":"="+encodeURIComponent(l))}function h(j,l){var r=l?f:e,q=[],u;for(u in j){var p=j[u];if(p&&p.push&&p.sort)for(var v=0;v<p.length;++v)q.push(r(u,p[v]));else p!=g&&q.push(r(u,p))}return q.join(";")}
var g=null,i=g,k=g,m={},o=[m],t={},s=g,w=[],y=[],n=window.ias||{};n.SetNamespace=function(j){i=j};n.SetContext=function(j){m=b(j);o[o.length-1]=m;k=g};n.SetContextPart=function(j,l){if(l!=g)m[j]=l;else delete m[j];k=g};n.ResetContext=function(j){o=[];c(j)};n.SetTag=d;n.SetTags=function(j){for(var l in j)d(l,j[l])};n.ResetTags=function(j){t=b(j);s=g};n.PushContext=c;n.PopContext=function(){o.pop();o.length||o.push({});m=o[o.length-1];k=g};n.AddDiscoveryCddUrl=function(j){w.push(j)};n.AddApplicableCddUrl=
function(j){y.push(j)};a.UPK_GetNamespace=function(){return i};a.UPK_GetContext=function(){if(k==g)k=h(m);return k};a.UPK_GetTags=function(){if(s==g)s=h(t,true);return s};a.UPK_GetDiscoveryCddUrls=function(){return w.length?w:g};a.UPK_GetApplicableCddUrls=function(){return y.length?y:g};return n}(window);ias.SetTag("upk-trait-nohelp","");document.write('<script type="text/javascript" src="'+lms_path+'kpsettings.js"><\/script>');document.write('<script type="text/javascript" src="'+lms_path+'config.js"><\/script>');
document.write('<script type="text/javascript" src="'+lms_path+'js/resource.js"><\/script>');function lms_LoadAdapterComplete(){__Ialert("lms_LoadAdapterComplete() called");var a=document.LmsCom;a.Begin();a.assessment_guid&&a.doSetUPKValue("upk.actual_guid",a.assessment_guid);a.OpenQuestionStatus();lms_UpdateUI(a.status_obj.getStatus());lms_initialized=true;setTimeout(lms_store.callbackfunction,1)}
function lms_Score(a,b,c,d,e){__alert("lms_Score called with parameters: "+a+","+b+","+c+","+e);a=document.LmsCom;var f=a.status_obj;switch(b){case "FillinBlank":f.setQuestionType("fill-in");c&&f.setLearnerResponse(c[0]);break;case "Hotspot":f.setQuestionType("choice");c&&f.setLearnerResponse(c[0]);break;case "Matching":f.setQuestionType("matching");if(c){b="";for(var h=0;h<c.length;h++)if(c[h])b+="[,]"+h+"[.]"+c[h];b&&f.setLearnerResponse(b.substring(3))}break;case "MultipleChoiceSingleAnswer":f.setQuestionType("choice");
c&&f.setLearnerResponse("#"+d[0]+"#");break;case "MultipleChoiceManyAnswer":f.setQuestionType("choice");if(c){b="";for(h=0;h<c.length;h++){if(h>0)b+="[,]";b+="#"+d[h]+"#"}f.setLearnerResponse(b)}break;case "TrueFalse":f.setQuestionType("true-false");c&&f.setLearnerResponse(c[0]);break;case "UserDefined":f.setQuestionType("other");c&&f.setLearnerResponse(c[0]);break;default:alert("Unanticipated question type: "+b);return}if(e=="correct"){f.setResult(e);f.setStatus(LMS_PASSED)}else{e=="incorrect"?f.setResult(e):
f.setResult(null);f.setStatus(LMS_FAILED)}a.setInteraction(0,document.LmsCom);a.SaveStatus();a.NotifyParent()}function lms_GetRemediationMode(){__alert("lms_GetRemediationInfo called");if(GetTopLevelLmsMode()==="KPT")return-1;return document.LmsCom.doGetUPKValue("upk.feedback_mode")}var _lms_module_name="lms_question.js",_lms_show_alert=false,_lms_show_Ialert=false;
